{"version":3,"sources":["../../srcwww/_header.js","../../srcwww/utils.js","../../srcwww/accessibility.js","../../srcwww/status.js","../../srcwww/attempt.js","../../srcwww/feedback.js","../../srcwww/exercises.js","../../srcwww/autocomplete.js","../../srcwww/sections.js","../../srcwww/grading.js","../../srcwww/ace-monochrome.js","../../srcwww/lib/bootstrap/src/util.js","../../srcwww/lib/bootstrap/src/modal.js"],"names":["exports","window","Exam","utils","preventDefault","e","generateRandomId","prefix","Math","random","toString","slice","storeGet","key","JSON","parse","localStorage","getItem","storeSet","value","setItem","stringify","storeRemove","removeItem","initNumericInputs","numRegexp","$","each","input","this","feedbackId","randomId","change","newVal","val","remove","test","attr","addClass","after","length","parseFloat","removeAttr","removeClass","lang","store","get","set","rem","formatDate","timestamp","Date","toLocaleString","disableNumberInputDefaults","numberInputs","on","which","off","debounce","fun","wait","immediate","timerId","context","args","arguments","delayed","apply","callImmediately","clearTimeout","setTimeout","triggerMathJax","id","isDummy","MathJax","startup","promise","then","el","parent","append","html","typesetPromise","err","console","warn","message","renderMathJax","toggleShim","show","spinOverlay","children","prepend","op","offsetParent","accessibility","getOrMakeId","newId","ariaAssociate","ariaAttribute","target","ref","evalMediaQueryList","mql","media","matches","useHighContrast","stored","matchMedia","highContrastTheme","enabled","exercises","click","hasClass","question","find","ariaLabelledBy","labelEl","ariaDescribedBy","status","fixMainOffset","statusContainer","css","outerHeight","parseTimestamp","parseInt","text","isNaN","showErrorDialog","title","content","action","button","triggerId","triggerEvent","triggerDelay","closeBtn","dialogContainerFooter","dialogContainerTitle","dialogContainerContent","hide","one","location","reload","trigger","dialogContainer","appendTo","document","body","detach","modal","keyboard","backdrop","messages","defaultContext","currentContext","statusMessageEl","Shiny","addCustomMessageHandler","condition","type","resetMessages","getMessage","what","setContext","where","attempt","toBase10","updateTimeLeft","msLeft","timelimit","Number","POSITIVE_INFINITY","timerEl","progressEl","config","gracePeriod","hrsLeft","floor","minLeft","secLeft","timerIsShown","timelimitTimer","timeoutMsg","active","progressMsg","sectionProgress","section","replace","totalSections","timerHtml","timer","progressive","haveTimelimit","combined","progressbar","progressbarEl","updateSection","currentSectionNr","width","round","feedback","runAfterUpdate","func","shinyRenderDelay","attemptChanged","sel","setInputValue","filter","data","userChanged","updateAttemptSelector","attempts","current","attemptSelectorId","options","map","at","finishedAt","startedAt","join","prop","questionFooter","card","footer","saveFeedbackCallback","qid","currentAttemptId","points","comment","maxPoints","saveFeedbackDelay","pointsChanged","event","parents","numVal","saveFeedback","commentChanged","toggleCommentVisible","toggleBtn","commentsInputGroup","commentsBtn","addCommentLabel","hiddenComment","removeCommentLabel","focus","renderDefaultFeedback","grading","solution","solutionLabel","badge","pointsInputId","commentInputId","saveFeedbackDebounced","_badge","outof","commentLabel","centerEl","correctIcon","incorrectIcon","numFormat","Intl","NumberFormat","undefined","signDisplay","style","minimumSignificantDigits","maximumSignificantDigits","feedbackRenderer","userSelectorId","sections","showAll","attemptLabel","users","userSel","user","displayName","allAttempts","userId","feedbackMap","Object","fromEntries","totalPoints","awardedPoints","label","i","end","selector","callback","NaN","push","answer","cbs","forEach","weight","weightStr","format","correctValues","Set","cb","has","editor","setReadOnly","getSession","setValue","registerFeedbackRenderer","unshift","attachAceEditor","code","ace","edit","setHighlightActiveLine","setShowPrintMargin","setShowFoldWidgets","setBehavioursEnabled","renderer","setDisplayIndentGuides","setTheme","currentTheme","$blockScrolling","Infinity","session","setMode","getSelection","clearSelection","exerciseRunning","outputContainer","running","exerciseRunButtonEnabled","initializeExerciseEditor","exercise","exerciseOptions","codeLines","split","lines","max","min","kMinLines","kMaxDefaultLines","repeat","editorId","inputId","pointsLabel","messageStrings","exercisePanel","buttonLabel","notYetRun","outputTitle","exerciseEditor","inputLabel","runCodeButton","triggerClick","setFontSize","commands","addCommand","name","bindKey","win","mac","exec","updateAceHeight","setOptions","minLines","maxLines","resize","initializeEditorBindings","inputBindings","InputBinding","extend","scope","getId","subscribe","unsubscribe","getValue","getTime","register","outputBindings","OutputBinding","outputId","renderValue","result","footerClass","status_class","renderError","error","clearError","kThemeMonochrome","modifierCombination","kModifierKeyNone","ctrlKey","kModifierKeyCtrl","altKey","kModifierKeyAlt","metaKey","kModifierKeyMeta","shiftKey","kModifierKeyShift","isPopupOpen","completer","popup","isOpen","getCompletions","position","_","getTextRange","start","row","column","priority","aceAutocompleteCallback","exerciseLabel","initializeExerciseAutocomplete","autocomplete","startAutocomplete","execCommand","onChangeCallback","autocompleteTimerId","pos","getCursorPosition","line","getLine","delayMs","completers","enableBasicAutocompletion","enableLiveAutocompletion","keyBinding","addKeyboardHandler","handleKeyboard","autocompleteKeyboardHandler","hash","keyString","keyCode","modifierCombo","kKeycodeSpace","kKeycodeTab","activated","command","customRCompleter","insertMatch","ranges","selection","getAllRanges","filterLength","completions","filterText","caption","is_function","navigateLeft","suggestions","item","score","meta","x","finishedRecalculating","currentSectionEl","actualSections","recalculatedDelay","currentSection","search","outputElements","recalculating","recalculatingTimerId","order","sectionsConfig","hideLastSection","last","updateGrading","gradingData","feedbackShown","toggleFeedback","btn","prepareQuestion","pointsEl","container","placeholder","pointsInput","feedbackBtn","feedbackLabel","startGrading","disableProgress","studentNameInputId","attemptInputId","define","acequire","module","isDark","cssClass","cssText","importCssString","toType","obj","call","match","toLowerCase","getSpecialTransitionEndEvent","bindType","TRANSITION_END","delegateType","handle","transitionEndEmulator","duration","_this","called","Util","setTransitionEndSupport","MAX_UID","MILLISECONDS_MULTIPLIER","getUID","getSelectorFromElement","element","hrefAttr","getTransitionDurationFromElement","transitionDuration","transitionDelay","floatTransitionDuration","floatTransitionDelay","reflow","offsetHeight","triggerTransitionEnd","supportsTransitionEnd","Boolean","isElement","nodeType","typeCheckConfig","componentName","configTypes","property","expectedTypes","valueType","RegExp","Error","toUpperCase","findShadowRoot","attachShadow","getRootNode","root","ShadowRoot","parentNode","jQueryDetection","TypeError","version","minMinor","_extends","assign","source","prototype","hasOwnProperty","JQUERY_NO_CONFLICT","ESCAPE_KEYCODE","Default","DATA_KEY","$__default","fn","NAME","DefaultType","EVENT_FOCUSIN","EVENT_KEY","EVENT_RESIZE","EVENT_CLICK_DISMISS","EVENT_KEYDOWN_DISMISS","EVENT_MOUSEUP_DISMISS","EVENT_MOUSEDOWN_DISMISS","EVENT_CLICK_DATA_API","CLASS_NAME_SCROLLABLE","CLASS_NAME_SCROLLBAR_MEASURER","CLASS_NAME_BACKDROP","CLASS_NAME_OPEN","CLASS_NAME_FADE","DATA_API_KEY","CLASS_NAME_SHOW","CLASS_NAME_STATIC","SELECTOR_DIALOG","SELECTOR_MODAL_BODY","SELECTOR_DATA_TOGGLE","SELECTOR_DATA_DISMISS","SELECTOR_FIXED_CONTENT","SELECTOR_STICKY_CONTENT","Modal","_isShown","_isBodyOverflowing","_getConfig","_ignoreBackdropClick","_isTransitioning","querySelector","_scrollbarWidth","_proto","toggle","relatedTarget","showEvent","isDefaultPrevented","EVENT_SHOW","_setEscapeEvent","_showBackdrop","_showElement","hideEvent","Event","EVENT_HIDE","transition","_element","_hideModal","_dialog","Util__default","_this2","_backdrop","removeData","handleUpdate","_triggerBackdropTransition","_config","hideEventPrevented","EVENT_HIDE_PREVENTED","modalTransitionDuration","classList","add","emulateTransitionEnd","overflowY","_this3","_this4","appendChild","modalBody","Node","ELEMENT_NODE","removeAttribute","setAttribute","scrollTop","_enforceFocus","shownEvent","EVENT_SHOWN","transitionComplete","_this5","_this6","_setResizeEvent","_this7","_this8","_resetAdjustments","EVENT_HIDDEN","_removeBackdrop","_this9","createElement","animate","backdropTransitionDuration","callbackRemove","_backdropTransitionDuration","_adjustDialog","isModalOverflowing","paddingLeft","paddingRight","_checkScrollbar","rect","_setScrollbar","left","right","innerWidth","_this10","fixedContent","calculatedPadding","stickyContent","actualMargin","marginRight","calculatedMargin","actualPadding","querySelectorAll","elements","margin","index","_getScrollbarWidth","scrollDiv","scrollbarWidth","className","_jQueryInterface","removeChild","_typeof","VERSION","tagName","$target"],"mappings":"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","file":"exam.min.js","sourcesContent":["if (typeof exports === 'undefined') {\n  window.exports = window.Exam = {}\n}\n","exports.utils = (function () {\n  'use strict'\n\n  const arrowKeyUp = 38\n  const arrowKeyDown = 40\n  const lang = $('html').attr('lang') || 'en-US'\n\n  function preventDefault (e) {\n    e.preventDefault()\n  }\n\n  function generateRandomId (prefix) {\n    if (!prefix) {\n      prefix = 'anonymous-el-'\n    }\n    return prefix + Math.random().toString(36).slice(2)\n  }\n\n  function storeGet (key) {\n    return JSON.parse(window.localStorage.getItem('examinr_' + key))\n  }\n\n  function storeSet (key, value) {\n    return window.localStorage.setItem('examinr_' + key, JSON.stringify(value))\n  }\n\n  function storeRemove (key) {\n    return window.localStorage.removeItem('examinr_' + key)\n  }\n\n  function initNumericInputs () {\n    const numRegexp = /^-?(\\d*\\.)?\\d+$/\n    $('.examinr-q-numeric input[type=text]').each(function () {\n      const input = $(this)\n      const feedbackId = exports.utils.randomId()\n\n      input.change(function () {\n        const newVal = input.val()\n        $('#' + feedbackId).remove()\n        if (newVal && !numRegexp.test(newVal)) {\n          input.attr('aria-describedby', feedbackId).addClass('is-invalid')\n            .after('<span id=\"' + feedbackId + '\" class=\"sr-only\">invalid value</span>')\n        } else {\n          if (newVal.length > 0) {\n            input.val(parseFloat(newVal))\n          }\n          input.removeAttr('aria-describedby').removeClass('is-invalid')\n        }\n      })\n    })\n  }\n\n  $(function () {\n    initNumericInputs()\n  })\n\n  return {\n    /**\n     * Enable or disable the high-contrast theme. If the argument is missing, the theme is determined based\n     * on the user's preference or the user-agent settings.\n     *\n     * @param {boolean|undefined} enabled\n     */\n    store: {\n      get: storeGet,\n      set: storeSet,\n      rem: storeRemove\n    },\n\n    /**\n     * Format the given date in the document's language\n     * @param {int} timestamp the timestamp to format\n     */\n    formatDate: function (timestamp) {\n      return new Date(timestamp).toLocaleString(lang)\n    },\n\n    /**\n     * Disable stepping by arrow keys and scrolling on number inputs.\n     *\n     * @param {jQuery} numberInputs the inputs to disable the defaults for.\n     */\n    disableNumberInputDefaults: function (numberInputs) {\n      if (!numberInputs) {\n        numberInputs = $('input[type=number]')\n      }\n\n      numberInputs.on('focus', function () {\n        $(this).on('wheel.disableScrollEvent', preventDefault)\n          .on('keydown.disableScrollEvent', function (e) {\n            if (e.which === arrowKeyDown || e.which === arrowKeyUp) {\n              e.preventDefault()\n            }\n          })\n      }).on('blur', function () {\n        $(this).off('.disableScrollEvent')\n      })\n    },\n    /**\n     * Debounce the given function, calling it only once for a series of shortly spaced calls.\n     * @param {function} fun function to debounce\n     * @param {integer} wait time (in ms) to wait before calling `fun`\n     * @param {boolean} immediate if `fun` should be called immediately on the raising edge, not the falling edge.\n     */\n    debounce: function (fun, wait, immediate) {\n      let timerId = null\n\n      return function () {\n        const context = this\n        const args = arguments\n        const delayed = function () {\n          timerId = null\n          if (!immediate) {\n            fun.apply(context, args)\n          }\n        }\n        const callImmediately = immediate && !timerId\n        window.clearTimeout(timerId)\n        timerId = window.setTimeout(delayed, wait)\n        if (callImmediately) {\n          fun.apply(context, args)\n        }\n      }\n    },\n    randomId: generateRandomId,\n    /**\n     * Render any math in the element with the given id\n     *\n     * @param {string} id id of the element to render math.\n     * @param {boolean} isDummy if true, the id attribute is removed.\n     */\n    triggerMathJax: function (id, isDummy) {\n      if (window.MathJax && window.MathJax.startup && window.MathJax.startup.promise) {\n        window.MathJax.startup.promise = window.MathJax.startup.promise\n          .then(() => {\n            let el = $('#' + id)\n            if (isDummy) {\n              const parent = el.parent()\n              if (parent.length > 0) {\n                parent.append(el.remove().html())\n                el = parent\n              }\n            }\n            return window.MathJax.typesetPromise(el)\n          })\n          .catch((err) => window.console.warn('Cannot typeset math: ', err.message))\n        return window.MathJax.startup.promise\n      }\n    },\n\n    /**\n     * Render any math in the element with the given id\n     *\n     * @param {jQuery} el element to render math in\n     */\n    renderMathJax: function (el) {\n      if (window.MathJax && window.MathJax.startup && window.MathJax.startup.promise) {\n        window.MathJax.startup.promise = window.MathJax.startup.promise\n          .then(() => {\n            return window.MathJax.typesetPromise(el)\n          })\n          .catch((err) => window.console.warn('Cannot typeset math: ', err.message))\n        return window.MathJax.startup.promise\n      }\n    },\n\n    /**\n     * Toggle a \"working\" shim over the given element.\n     * @param {jQuery} el jquery element which should be covered by the shim.\n     * @param {boolean} show force the shim to be shown/hidden, regardless of the current state.\n     */\n    toggleShim: function (el, show) {\n      if (!el) {\n        // Overlay over entire document\n        el = $('body')\n      } else {\n        el = $(el)\n      }\n\n      let spinOverlay = el.children('.examinr-recompute-overlay')\n\n      // If `show` is missing, show the overlay if it's not present at the moment\n      if (typeof show === 'undefined') {\n        show = (spinOverlay.length === 0)\n      }\n\n      if (show === false) {\n        spinOverlay.remove()\n        el.removeClass('examinr-recompute-outer')\n      } else {\n        spinOverlay = $('<div class=\"examinr-recompute-overlay\"><div class=\"examinr-recompute\" role=\"status\">' +\n                          '<span class=\"sr-only\">Loading...</span>' +\n                        '</div></div>')\n        el.prepend(spinOverlay)\n        const op = spinOverlay.offsetParent()\n        if (op.length > 0 && op.get(0) !== el.get(0)) {\n          el.addClass('examinr-recompute-outer')\n        }\n        el.show()\n      }\n    }\n  }\n}())\n","exports.accessibility = (function () {\n  'use strict'\n\n  function getOrMakeId (el) {\n    if (el.attr('id')) {\n      return el.attr('id')\n    }\n    const newId = exports.utils.randomId('aria-el-')\n    el.attr('id', newId)\n    return newId\n  }\n\n  function ariaAssociate (ariaAttribute, target, ref) {\n    target.attr('aria-' + ariaAttribute, getOrMakeId(ref))\n  }\n\n  /**\n   * Determine if the given media query list is (a) not supported or (b) matches.\n   * @param {MediaQueryList} mql\n   */\n  function evalMediaQueryList (mql) {\n    return (mql.media === 'not all') || mql.matches\n  }\n\n  function useHighContrast () {\n    const stored = exports.utils.store.get('highContrast')\n    if (stored === null) {\n      // Determine based on the user-agent settings.\n      return !(evalMediaQueryList(window.matchMedia('not speech')) &&\n        evalMediaQueryList(window.matchMedia('(monochrome: 0)')) &&\n        evalMediaQueryList(window.matchMedia('(forced-colors: none)')) &&\n        evalMediaQueryList(window.matchMedia('(inverted-colors: none)')) &&\n        evalMediaQueryList(window.matchMedia('not (prefers-contrast: more)')))\n    }\n    return (stored !== false)\n  }\n\n  /**\n  * Enable or disable the high-contrast theme. If the argument is missing, the theme is determined based\n  * on the user's preference or the user-agent settings.\n  *\n  * @param {boolean|undefined} enabled\n  */\n  function highContrastTheme (enabled) {\n    if (enabled !== true && enabled !== false) {\n      enabled = useHighContrast()\n    }\n    if (enabled) {\n      enabled = true\n      $('html').addClass('high-contrast')\n    } else {\n      $('html').removeClass('high-contrast')\n      enabled = false\n    }\n    exports.utils.store.set('highContrast', enabled)\n    exports.exercises.highContrastTheme(enabled)\n    exports.utils.store.set('highContrast', enabled)\n  }\n\n  $(function () {\n    $('a:empty').attr('aria-hidden', 'true')\n    highContrastTheme()\n    $('.btn-high-contrast').click(function () {\n      highContrastTheme(!$('html').hasClass('high-contrast'))\n    })\n\n    // add labels to question containers and hide labels from UI if requested\n    $('.examinr-question').each(function () {\n      const question = $(this)\n      question.find('.hide-label .control-label').addClass('sr-only')\n      ariaAssociate('labelledby', question, question.find('.card-header'))\n    })\n  })\n\n  return {\n    /**\n     * Enable or disable the high-contrast theme. If the argument is missing, the theme is determined based\n     * on the user's preference or the user-agent settings.\n     *\n     * @param {boolean|undefined} enabled\n     */\n    highContrastTheme: highContrastTheme,\n    ariaAssociate: ariaAssociate,\n    ariaLabelledBy: function (el, labelEl) {\n      ariaAssociate('labelledby', el, labelEl)\n    },\n    ariaDescribedBy: function (el, labelEl) {\n      ariaAssociate('describedby', el, labelEl)\n    }\n  }\n}())\n","exports.status = (function () {\n  'use strict'\n\n  let messages = {}\n  let statusContainer\n  const defaultContext = 'info'\n  let currentContext = defaultContext\n\n  const dialogContainerTitle = $('<h4 class=\"modal-title\" id=\"' +\n    exports.utils.randomId('examinr-status-dialog-title-') + '\">')\n  const dialogContainerContent = $('<div class=\"modal-body\" id=\"' +\n    exports.utils.randomId('examinr-status-dialog-body-') + '\">')\n  const dialogContainerFooter = $(\n    '<div class=\"modal-footer\">' +\n      '<button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">Close</button>' +\n    '</div>')\n  const dialogContainer = $(\n    '<div class=\"modal\" tabindex=\"-1\" role=\"alertdialog\" ' +\n        'aria-labelledby=\"' + dialogContainerTitle.attr('id') + '\"' +\n        'aria-describedby=\"' + dialogContainerContent.attr('id') + '\">' +\n      '<div class=\"modal-dialog modal-lg\" role=\"document\">' +\n        '<div class=\"modal-content\"><div class=\"modal-header\"></div></div>' +\n      '</div>' +\n    '</div>')\n\n  const statusMessageEl = $('<div class=\"lead\" role=\"alert\"></div>')\n\n  dialogContainer.find('.modal-header').append(dialogContainerTitle)\n  dialogContainer.find('.modal-content').append(dialogContainerContent).append(dialogContainerFooter)\n\n  /**\n   * Show a status message.\n   * @param {object} condition the condition object to show. Must contain the following elements:\n   *  type {string} one of \"error\", \"locked\", \"warning\", or \"info\"\n   *  message {string} the status message, may contain HTML\n   *  title {string} (for type \"error\" or \"locked\") the title for the error dialog\n   *  button {string} (for type \"error\") the button label for the error dialog\n   *  action {string} (for type \"error\") the action associated with the button. If \"reload\", the page is reloaded,\n   *    otherwise, the dialog is simply closed.\n   */\n  Shiny.addCustomMessageHandler('__.examinr.__-statusMessage', function (condition) {\n    statusContainer.removeClass('alert-warning')\n    statusMessageEl.detach()\n    if (condition.type === 'error') {\n      showErrorDialog(condition.content.title, condition.content.body, condition.action, condition.content.button,\n        condition.triggerId, condition.triggerEvent, condition.triggerDelay)\n    } else if (condition.type === 'locked') {\n      showErrorDialog(condition.content.title, condition.content.body, 'none', '')\n      $('main').hide()\n    } else {\n      statusMessageEl.html(condition.content.body)\n        .find('.examinr-timestamp')\n        .each(parseTimestamp)\n\n      exports.utils.toggleShim($('body'), false)\n\n      statusContainer.removeClass('alert-info')\n        .addClass(condition.type === 'warning' ? 'alert-warning' : 'alert-info')\n        .children('.col-center')\n        .append(statusMessageEl)\n    }\n    fixMainOffset()\n  })\n\n  /**\n   * Fix the top offset of the main content to make room for the status container.\n   */\n  function fixMainOffset () {\n    if (statusContainer && statusContainer.length > 0) {\n      $('body').css('paddingTop', statusContainer.outerHeight())\n    }\n  }\n\n  /**\n   * Parse the content inside the element as timestamp and replace with the browser's locale date-time string.\n   */\n  function parseTimestamp () {\n    const el = $(this)\n    const timestamp = parseInt(el.text(), 10)\n    if (timestamp && !isNaN(timestamp)) {\n      el.text(exports.utils.formatDate(timestamp * 1000))\n    } else {\n      el.text('')\n    }\n  }\n\n  /**\n   * Show a modal error dialog.\n   * @param {string} title title of the dialog, may contain HTML\n   * @param {string} content content of the dialog, may contain HTML\n   * @param {string} action what action should be taken when the button is clicked. If \"reload\", the browser is\n   *   instructed to reload the page. If \"none\", the dialog cannot be closed. In all other cases,\n   *   clicking the button will close the dialog.\n   * @param {string} button label for the button, may not contain HTML\n   */\n  function showErrorDialog (title, content, action, button, triggerId, triggerEvent, triggerDelay) {\n    const closeBtn = dialogContainerFooter.children('button')\n\n    dialogContainerTitle.html(title).find('.examinr-timestamp').each(parseTimestamp)\n    dialogContainerContent.html(content).find('.examinr-timestamp').each(parseTimestamp)\n\n    if (action === 'none') {\n      dialogContainerFooter.hide()\n    } else {\n      closeBtn.text(button)\n      if (action === 'reload') {\n        closeBtn.one('click', function () {\n          window.location.reload()\n        })\n      } else if (action === 'trigger' && triggerId && triggerEvent) {\n        closeBtn.one('click', function () {\n          if (triggerDelay) {\n            exports.utils.toggleShim($('body'), true)\n            window.setTimeout(() => $('#' + triggerId).trigger(triggerEvent), triggerDelay)\n          } else {\n            $('#' + triggerId).trigger(triggerEvent)\n          }\n        })\n      }\n    }\n\n    exports.utils.toggleShim($('body'), false)\n\n    dialogContainer.attr('role', (action === 'none') ? 'dialog' : 'errordialog')\n      .appendTo(document.body)\n      .one('hidden.bs.modal', function () {\n        dialogContainer.detach()\n      })\n      .modal({\n        keyboard: false,\n        backdrop: 'static',\n        show: true\n      })\n  }\n\n  $(function () {\n    exports.utils.toggleShim($('body'), true)\n    statusContainer = $('.examinr-exam-status')\n    messages = JSON.parse($('script.examinr-status-messages').remove().text() || '{}')\n    statusContainer.addClass('alert alert-' + currentContext)\n    fixMainOffset()\n  })\n\n  return {\n    /**\n     * Reset (i.e., hide) the status messages\n     */\n    resetMessages: function () {\n      statusMessageEl.detach()\n      dialogContainer.detach()\n      statusContainer.removeClass('alert-warning alert-danger').addClass('alert-info')\n      fixMainOffset()\n    },\n\n    /**\n     * Get the message associated with an identifier.\n     * @param {string} what the message identifier\n     * @returns the message for the given identifier, or null if the identifier is unknown.\n     */\n    getMessage: function (what) {\n      return messages[what] || null\n    },\n\n    /**\n     * Set the context of the status bar.\n     * @param {string} context the context class, one of info, warning, danger. If missing, reset to the default\n     *   context class.\n     */\n    setContext: function (context) {\n      if (!context) {\n        context = defaultContext\n      }\n      statusContainer.removeClass('alert-' + currentContext).addClass('alert-' + context)\n      currentContext = context\n    },\n\n    /**\n     * Append the element to the status bar and adjust the offset.\n     * @param {jQuery} el the element to append\n     * @param {string} where where to append the element. Can be one of \"left\", \"center\" or \"right\"\n     */\n    append: function (el, where) {\n      el = $(el)\n      switch (where) {\n        case 'left':\n          statusContainer.children('.col-left').append(el)\n          break\n        case 'right':\n          statusContainer.children('.col-right').append(el)\n          break\n        case 'center':\n        default:\n          statusContainer.children('.col-center').append(el)\n      }\n      fixMainOffset()\n      return el\n    },\n\n    /**\n     * Remove the element from the status bar and adjust the offset.\n     * @param {jQuery} el the element to remove\n     */\n    remove: function (el) {\n      el.remove()\n      fixMainOffset()\n    },\n\n    /**\n    * Fix the top offset of the main content to make room for the status bar.\n    */\n    fixMainOffset: fixMainOffset,\n\n    /**\n     * Show a modal error dialog.\n     * @param {string} title title of the dialog, may contain HTML\n     * @param {string} content content of the dialog, may contain HTML\n     * @param {string} action what action should be taken when the button is clicked. If \"reload\", the browser is\n     *   instructed to reload the page. If \"none\", the dialog cannot be closed. In all other cases,\n     *   clicking the button will close the dialog.\n     * @param {string} button label for the button, may not contain HTML\n     */\n    showErrorDialog: showErrorDialog\n  }\n}())\n","exports.attempt = (function () {\n  'use strict'\n\n  let config = {}\n  let timelimitTimer\n  let timelimit = Number.POSITIVE_INFINITY\n  let timerIsShown = false\n\n  const progressEl = $('<div class=\"examinr-progress\" role=\"status\"></div>')\n\n  /** Update the current attempt information.\n   *\n   * @param {object} attempt an object with the following properties:\n   *   - {boolean} active whether there is an active attempt.\n   *   - {integer} timelimit the timestamp (in seconds) when the current attempt is closed.\n   */\n  Shiny.addCustomMessageHandler('__.examinr.__-attemptStatus', function (attempt) {\n    if (attempt.gracePeriod) {\n      config.gracePeriod = attempt.gracePeriod\n    }\n    if (attempt && attempt.active) {\n      $('main').show().trigger('shown')\n      progressEl.show()\n\n      if (attempt.timelimit !== 0 && (!attempt.timelimit || attempt.timelimit === 'Inf')) {\n        attempt.timelimit = Number.POSITIVE_INFINITY\n      }\n      try {\n        timelimit = new Date(attempt.timelimit * 1000)\n        if (timelimitTimer) {\n          window.clearTimeout(timelimitTimer)\n          timelimitTimer = false\n        }\n        updateTimeLeft()\n      } catch (e) {\n        window.console.warn('Cannot set timelimit for current attempt:', e)\n        timelimit = Number.POSITIVE_INFINITY\n      }\n    } else {\n      $('main').hide()\n      exports.status.remove(progressEl)\n      exports.status.setContext()\n    }\n  })\n\n  function toBase10 (val) {\n    return (val >= 10 ? val.toString(10) : '0' + val.toString(10))\n  }\n\n  /**\n   * Update the \"time left\" status.\n   */\n  function updateTimeLeft () {\n    let msLeft = timelimit === Number.POSITIVE_INFINITY ? Number.POSITIVE_INFINITY : timelimit - new Date()\n    const timerEl = progressEl.find('.examinr-timer')\n\n    if (!isNaN(msLeft) && msLeft < Number.POSITIVE_INFINITY) {\n      if (msLeft < 1 && msLeft > -1000 * (config.gracePeriod || 1)) {\n        msLeft = 0\n      }\n      if (msLeft >= 0) {\n        const hrsLeft = Math.floor(msLeft / 3600000)\n        const minLeft = Math.floor((msLeft % 3600000) / 60000)\n        const secLeft = Math.floor((msLeft % 60000) / 1000)\n\n        if (hrsLeft > 0) {\n          timerEl.children('.hrs').removeClass('ignore').text(toBase10(hrsLeft))\n        } else {\n          timerEl.children('.hrs').addClass('ignore').text('00')\n        }\n        timerEl.children('.min').text(toBase10(minLeft))\n        if (hrsLeft > 0 || minLeft >= 10) {\n          timerEl.children('.min').addClass('nosec')\n          timerEl.children('.sec').hide()\n        } else {\n          timerEl.children('.min').removeClass('nosec')\n          timerEl.children('.sec').show().text(toBase10(secLeft))\n        }\n        timerEl.show()\n\n        if (!timerIsShown) {\n          exports.status.fixMainOffset()\n          timerIsShown = true\n        }\n\n        if (hrsLeft > 0 || minLeft >= 12) {\n          timelimitTimer = window.setTimeout(updateTimeLeft, 60000) // call every minute\n        } else {\n          if (minLeft < 5) {\n            exports.status.setContext('danger')\n          } else if (minLeft < 10) {\n            exports.status.setContext('warning')\n          }\n          timelimitTimer = window.setTimeout(updateTimeLeft, 1000) // call every second\n        }\n      } else {\n        // Time is up. Destroy the interface.\n        $('main').remove()\n        const timeoutMsg = exports.status.getMessage('attemptTimeout')\n        exports.status.showErrorDialog(timeoutMsg.title, timeoutMsg.body, 'none')\n      }\n    } else {\n      timerEl.hide()\n    }\n  }\n\n  $(function () {\n    config = JSON.parse($('script.examinr-attempts-config').remove().text() || '{}')\n    const progressMsg = exports.status.getMessage('progress')\n\n    if (progressMsg) {\n      // replace the following format strings:\n      // - \"{section_nr}\" with an element holding the current section number\n      // - \"{total_sections}\" with an element holding the total number of sections\n      // - \"{time_left}\" with an element holding the time left\n      const sectionProgress = progressMsg.section\n        .replace('{section_nr}', '<span class=\"examinr-section-nr\">1</span>')\n        .replace('{total_sections}', '<span class=\"examinr-total-sections\">' + (config.totalSections || 1) +\n                  '</span>')\n      const timerHtml = progressMsg.timer\n        .replace('{time_left}', '<span class=\"examinr-timer\" role=\"timer\">' +\n                                  '<span class=\"hrs\">??</span>' +\n                                  '<span class=\"min\">??</span>' +\n                                  '<span class=\"sec\"></span>' +\n                                '</span>')\n\n      if (config.progressive || config.haveTimelimit) {\n        if (config.progressive && config.haveTimelimit) {\n          progressEl.html(progressMsg.combined\n            .replace('{section}', sectionProgress)\n            .replace('{timer}', timerHtml))\n        } else if (config.progressive) {\n          progressEl.html(sectionProgress)\n        } else if (config.haveTimelimit) {\n          progressEl.html(timerHtml)\n        }\n\n        exports.status.append(progressEl)\n        updateTimeLeft()\n      }\n    }\n\n    if (config.progressbar) {\n      const progressbarEl = $(\n        '<div class=\"progress\">' +\n          '<div class=\"progress-bar\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"' +\n            config.totalSections + '\" style=\"min-width: 2em;\">' +\n          '</div>' +\n        '</div>')\n      exports.status.append(progressbarEl)\n    }\n  })\n\n  return {\n    /**\n     * Update the current section number.\n     * @param {int} currentSectionNr the current section number\n     */\n    updateSection: function (currentSectionNr) {\n      if (!currentSectionNr || isNaN(currentSectionNr) || currentSectionNr < 0 ||\n          currentSectionNr > config.totalSections) {\n        progressEl.hide()\n      } else {\n        progressEl.show().find('.examinr-section-nr').text(currentSectionNr)\n        if (config.progressbar) {\n          progressEl.find('.progress-bar')\n            .attr('aria-valuenow', currentSectionNr)\n            .width(Math.round(100 * currentSectionNr / config.totalSections) + '%')\n        }\n      }\n    }\n  }\n}())\n","exports.feedback = (function () {\n  'use strict'\n\n  const correctIcon = '<svg aria-label=\"correct\" class=\"examinr-feedback-annotation\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z\"/></svg>'\n\n  const incorrectIcon = '<svg aria-label=\"incorrect\" class=\"examinr-feedback-annotation\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z\"/></svg>'\n\n  const addCommentLabel = 'Add comment'\n  const removeCommentLabel = 'Remove comment'\n\n  const numFormat = window.Intl.NumberFormat(undefined, {\n    signDisplay: 'never',\n    style: 'decimal',\n    minimumSignificantDigits: 1,\n    maximumSignificantDigits: 3\n  })\n\n  const feedbackRenderer = []\n  const shinyRenderDelay = 250\n  const saveFeedbackDelay = 250\n  const attemptSelectorId = exports.utils.randomId('attempt-sel')\n  const userSelectorId = exports.utils.randomId('user-sel')\n  let currentAttemptId\n  let centerEl\n\n  function runAfterUpdate (input, func) {\n    func()\n    input.one('shiny:updateinput', function () {\n      window.setTimeout(func, shinyRenderDelay)\n    })\n  }\n\n  function attemptChanged () {\n    const sel = $(this)\n    exports.utils.toggleShim($('body'), true)\n    // update the input value for the autocomplete input\n    Shiny.setInputValue('__.examinr.__-attemptSel', sel.val())\n\n    // Check if the selected attempt is finished, otherwise add a visual feedback\n    if (!sel.children('option').filter(':selected').data('finishedat')) {\n      sel.addClass('is-not-finished')\n    } else {\n      sel.removeClass('is-not-finished')\n    }\n  }\n\n  function userChanged () {\n    const sel = $(this)\n    exports.utils.toggleShim($('body'), true)\n    // update the input value for the autocomplete input\n    Shiny.setInputValue('__.examinr.__-gradingUserSel', sel.val())\n  }\n\n  function updateAttemptSelector (attempts, current) {\n    const sel = $('#' + attemptSelectorId)\n    if (sel.length > 0 && attempts && attempts.length > 0) {\n      const options = attempts.map(at => (\n        '<option value=\"' + at.id + '\" data-finishedat=\"' + (at.finishedAt || '') + '\">' +\n          (at.finishedAt ? exports.utils.formatDate(at.finishedAt * 1000)\n            : 'Unfinished (started at ' + exports.utils.formatDate(at.startedAt * 1000) + ')') +\n        '</option>'\n      )).join('')\n\n      sel.html(options)\n        .prop('disabled', attempts.length < 2)\n        .removeClass('is-not-finished')\n\n      if (current) {\n        if (current.id) {\n          sel.val(current.id)\n        }\n        if (!current.finishedAt) {\n          sel.addClass('is-not-finished')\n        }\n      }\n    } else {\n      sel.prop('disabled', true)\n    }\n  }\n\n  /**\n   * Render feedback data\n   */\n  Shiny.addCustomMessageHandler('__.examinr.__-feedback', function (data) {\n    exports.utils.toggleShim($('body'), false)\n    exports.status.resetMessages()\n\n    data.grading = (data.grading === true)\n    if (!centerEl) {\n      $('.examinr-section-next').remove()\n      $('main').show()\n      exports.sections.showAll()\n\n      exports.status.append('<div class=\"input-group input-group-sm\">' +\n            '<div class=\"input-group-prepend\">' +\n              '<label class=\"input-group-text\" for=\"' + attemptSelectorId + '\">' +\n                exports.status.getMessage('feedback').attemptLabel +\n              '</label>' +\n            '</div>' +\n            '<select class=\"custom-select\" id=\"' + attemptSelectorId + '\"></select>' +\n          '</div>', 'right')\n        .children('#' + attemptSelectorId)\n        .change(attemptChanged)\n\n      if (data.grading) {\n        centerEl = exports.status.append('<div class=\"input-group input-group-sm\">' +\n            '<div class=\"input-group-prepend\">' +\n              '<button class=\"btn btn-secondary\" type=\"button\">' +\n                '<span aria-hidden=\"true\">&lt;</span>' +\n                '<span class=\"sr-only\">Previous student</span>' +\n              '</button>' +\n              '<label class=\"input-group-text\" for=\"' + userSelectorId + '\">' +\n                'User' +\n              '</label>' +\n            '</div>' +\n            '<select class=\"custom-select\" id=\"' + userSelectorId + '\" disabled></select>' +\n            '<div class=\"input-group-append\">' +\n              '<button class=\"btn btn-secondary\" type=\"button\">' +\n                '<span aria-hidden=\"true\">&gt;</span>' +\n                '<span class=\"sr-only\">Next Student</span>' +\n              '</button>' +\n            '</div>' +\n          '</div>')\n\n        if (data.users && data.users.length > 0) {\n          const userSel = centerEl.children('#' + userSelectorId)\n          userSel.prop('disabled', false)\n            .change(userChanged)\n            .append(data.users.map(user => (\n              '<option value=\"' + user.id + '\">' + (user.displayName || user.id) + '</option>'\n            )).join(''))\n        }\n      } else {\n        centerEl = exports.status.append('<span></span>')\n      }\n    }\n    updateAttemptSelector(data.allAttempts, data.attempt)\n    if (data.attempt) {\n      currentAttemptId = data.attempt.id\n      if (data.attempt.userId) {\n        centerEl.find('select').val(data.attempt.userId)\n      }\n    }\n\n    // turn feedback array into a map\n    const feedbackMap = Object.fromEntries(data.feedback.map(function (feedback) {\n      return [feedback.qid, feedback]\n    }))\n\n    let totalPoints = 0\n    let awardedPoints = 0\n\n    // Render feedback for text (or numeric) questions\n    $('.examinr-question').each(function () {\n      const question = $(this)\n      const label = question.data('questionlabel')\n      for (let i = 0, end = feedbackRenderer.length; i < end; i++) {\n        if (question.filter(feedbackRenderer[i].selector).length > 0) {\n          feedbackRenderer[i].callback(question, feedbackMap[label] || {}, data.grading)\n          if (label in feedbackMap) {\n            totalPoints += (feedbackMap[label].maxPoints || 0)\n            if (feedbackMap[label].points || feedbackMap[label].points === 0) {\n              awardedPoints += feedbackMap[label].points\n            } else {\n              awardedPoints = NaN\n            }\n            delete feedbackMap[label]\n          } else {\n            totalPoints += (question.data('maxpoints') || 0)\n            awardedPoints = NaN\n          }\n          return true\n        }\n      }\n      window.console.warn('No feedback renderer for question ' + label)\n    })\n\n    if (isNaN(awardedPoints)) {\n      awardedPoints = '&mdash;'\n    }\n\n    if (!data.grading) {\n      centerEl.html(exports.status.getMessage('feedback').status\n        .replace('{awarded_points}', awardedPoints)\n        .replace('{total_points}', totalPoints))\n    }\n\n    exports.status.fixMainOffset()\n  })\n\n  function questionFooter (question) {\n    const card = question.hasClass('card') ? question : question.find('.card')\n    const footer = card.find('.card-footer')\n    if (footer.length === 0) {\n      return $('<div class=\"card-footer\">').appendTo(card)\n    }\n    return footer\n  }\n\n  function saveFeedbackCallback (qid) {\n    return exports.utils.debounce(function (feedback) {\n      if (currentAttemptId) {\n        Shiny.setInputValue('__.examinr.__-saveFeedback', {\n          attempt: currentAttemptId,\n          qid: qid,\n          points: feedback.points,\n          comment: feedback.comment,\n          maxPoints: feedback.maxPoints\n        })\n      }\n    }, saveFeedbackDelay)\n  }\n\n  function pointsChanged (event) {\n    const input = $(this)\n    const question = input.parents('.examinr-question')\n    const feedback = question.data('feedback')\n    const numVal = parseFloat(input.val())\n    input.val(numVal)\n    if (!isNaN(numVal)) {\n      feedback.points = numVal\n      question.data('feedback', feedback)\n      event.data.saveFeedback(feedback)\n    }\n  }\n\n  function commentChanged (event) {\n    const input = $(this)\n    const question = input.parents('.examinr-question')\n    const feedback = question.data('feedback')\n    feedback.comment = input.val()\n    event.data.saveFeedback(feedback)\n    question.data('feedback', feedback)\n  }\n\n  function toggleCommentVisible (event) {\n    const toggleBtn = $(this)\n    const question = toggleBtn.parents('.examinr-question')\n    const feedback = question.data('feedback')\n    const commentsInputGroup = question.find('.examinr-grading-comment')\n    const commentsBtn = $(this)\n    if (commentsInputGroup.filter(':visible').length > 0) {\n      // Hide the comment box and remove the comment\n      commentsInputGroup.hide()\n      commentsBtn.find('.btn-label').html('+')\n      commentsBtn.find('.sr-only').text(addCommentLabel)\n      if (feedback.comment) {\n        feedback.hiddenComment = feedback.comment\n        feedback.comment = null\n        event.data.saveFeedback(feedback)\n      }\n    } else {\n      // Show the comment box and add the previously deleted comment\n      commentsInputGroup.show()\n      commentsBtn.find('.btn-label').html('&times;')\n      commentsBtn.find('.sr-only').text(removeCommentLabel)\n      if (feedback.hiddenComment) {\n        commentsInputGroup.find('textarea').val(feedback.hiddenComment).focus()\n        feedback.hiddenComment = null\n      }\n    }\n    question.data('feedback', feedback)\n  }\n\n  /**\n   * Add default feedback elements to a question.\n   * This renders the points (either as badge for feedback or as input element for grading) and appends\n   * the solution and any comments in the footer.\n   *\n   * @param {jQuery} question question element\n   * @param {Object} feedback feedback object\n   * @param {boolean} grading render for grading\n   */\n  function renderDefaultFeedback (question, feedback, grading) {\n    const footer = questionFooter(question)\n    // remove all previous feedback\n    footer.find('.examinr-grading-feedback').remove()\n\n    // Append the solution to the footer\n    if (feedback.solution) {\n      footer.append('<div class=\"examinr-grading-feedback\">' +\n      '<h6>' + exports.status.getMessage('feedback').solutionLabel + '</h6>' +\n      '<div>' + feedback.solution + '</div>' +\n      '</div>')\n    }\n\n    if (grading) {\n      if (question.find('.examinr-grading-points').length === 0) {\n        const badge = question.find('.examinr-points')\n        const pointsInputId = exports.utils.randomId('examinr-pts-')\n        const commentInputId = exports.utils.randomId('examinr-comment-')\n\n        badge.parent()\n          .addClass('clearfix')\n          .append('<div class=\"input-group input-group-sm examinr-points examinr-grading-points\">' +\n              '<label class=\"sr-only\" for=\"' + pointsInputId + '\">Points</label>' +\n              '<input type=\"number\" class=\"form-control\" id=\"' + pointsInputId + '\" step=\"any\" required ' +\n                'max=\"' + (2 * feedback.maxPoints) + '\" />' +\n              '<div class=\"input-group-append\">' +\n                '<span class=\"input-group-text\">' +\n                  '<span class=\"sr-only\"> out of </span>' +\n                  '<span class=\"examinr-points-outof\">' + badge.text() + '</span>' +\n                '</span>' +\n                '<button type=\"button\" class=\"btn btn-secondary\">' +\n                  '<span class=\"btn-label\" aria-hidden=\"true\">' + (feedback.comment ? '&times;' : '+') + '</span>' +\n                  '<span class=\"sr-only\">' + (feedback.comment ? removeCommentLabel : addCommentLabel) + '</span>' +\n                '</button>' +\n              '</div>' +\n            '</div>')\n\n        badge.remove()\n\n        footer.append('<div class=\"input-group examinr-grading-comment\">' +\n            '<div class=\"input-group-prepend\">' +\n              '<label class=\"input-group-text\" for=\"' + commentInputId + '\">Comment</label>' +\n            '</div>' +\n            '<textarea class=\"form-control\" id=\"' + commentInputId + '\"></textarea>' +\n          '</div>')\n\n        const saveFeedbackDebounced = { saveFeedback: saveFeedbackCallback(feedback.qid) }\n\n        question.find('#' + pointsInputId).on('change', saveFeedbackDebounced, pointsChanged)\n        question.find('#' + commentInputId).on('change', saveFeedbackDebounced, commentChanged)\n        question.find('.examinr-grading-points button').on('click', saveFeedbackDebounced, toggleCommentVisible)\n        if (!feedback.comment) {\n          footer.find('.examinr-grading-comment').hide()\n        }\n      }\n\n      question.find('.examinr-grading-points input').val(feedback.points)\n      question.data('feedback', feedback)\n    } else {\n      const badge = question.find('.examinr-points')\n      // Render the awarded points in the badge\n      if (badge.find('.examinr-points-awarded').length === 0) {\n        const outof = badge.text()\n        badge.html('<span class=\"examinr-points-awarded\"></span><span class=\"sr-only\"> out of </span> ' +\n                   '<span class=\"examinr-points-outof\">' + outof + '</span>')\n      }\n\n      if (feedback.points || feedback.points === 0) {\n        const context = feedback.points <= 0 ? 'danger'\n          : (feedback.points >= feedback.maxPoints ? 'success' : 'secondary')\n\n        badge.removeClass('badge-secondary badge-info badge-success badge-danger')\n          .addClass('badge-' + context)\n          .find('.examinr-points-awarded')\n          .addClass('lead')\n          .text(feedback.points)\n      } else {\n        badge.removeClass('badge-secondary badge-info badge-success badge-danger')\n          .addClass('badge-info')\n          .find('.examinr-points-awarded')\n          .removeClass('lead')\n          .html('&mdash;')\n      }\n    }\n\n    if (grading) {\n      if (feedback.comment) {\n        question.find('.examinr-grading-points .btn .btn-label').html('&times;')\n        question.find('.examinr-grading-points .btn .sr-only').text(removeCommentLabel)\n        footer.find('.examinr-grading-comment').show()\n          .find('textarea').val(feedback.comment)\n      } else {\n        question.find('.examinr-grading-points .btn .btn-label').html('+')\n        question.find('.examinr-grading-points .btn .sr-only').text(addCommentLabel)\n        footer.find('.examinr-grading-comment').hide()\n          .find('textarea').val('')\n      }\n    } else if (feedback.comment) {\n      footer.append('<div class=\"text-muted examinr-grading-feedback\">' +\n          '<h6>' + exports.status.getMessage('feedback').commentLabel + '</h6>' +\n          '<div>' + feedback.comment + '</div>' +\n        '</div>')\n    }\n\n    exports.utils.renderMathJax(footer)\n  }\n\n  // Default feedback renderer for built-in questions created by `text_question()`\n  feedbackRenderer.push({\n    selector: '.examinr-q-textquestion',\n    callback: function (question, feedback, grading) {\n      renderDefaultFeedback(question, feedback, grading)\n\n      question.find('.shiny-input-container input,.shiny-input-container textarea')\n        .prop('readonly', true)\n        .val(feedback.answer || '')\n    }\n  })\n\n  // Default feedback renderer for built-in questions created by `mc_question()`\n  feedbackRenderer.push({\n    selector: '.examinr-q-mcquestion',\n    callback: function (question, feedback, grading) {\n      const solution = feedback.solution\n      feedback.solution = null\n      renderDefaultFeedback(question, feedback, grading)\n\n      runAfterUpdate(question, function () {\n        // reset old feedback\n        question.find('.examinr-feedback-annotation').remove()\n        question.find('.shiny-input-container label').removeAttr('class')\n\n        // display new feedback\n        const cbs = question.find('input[type=checkbox],input[type=radio]')\n        cbs.prop('disabled', true).prop('checked', false)\n\n        if (feedback.answer) {\n          feedback.answer.forEach(sel => {\n            if (sel.weight) {\n              const context = sel.weight > 0 ? 'success' : 'danger'\n              const weightStr = (sel.weight > 0 ? '+' : '&minus;') + numFormat.format(sel.weight)\n              cbs.filter('[value=\"' + sel.value + '\"]')\n                .prop('checked', true)\n                .parent()\n                .append('<span class=\"examinr-feedback-annotation badge badge-pill badge-' + context + '\">' +\n                  weightStr + '</span>')\n            }\n          })\n        }\n\n        if (solution) {\n          const correctValues = new Set(solution)\n\n          cbs.each(function () {\n            const cb = $(this)\n            const label = cb.parent()\n            if (cb.prop('checked')) {\n              if (correctValues.has(cb.val())) {\n                label.addClass('text-success').prepend(correctIcon)\n              } else {\n                label.addClass('text-danger').prepend(incorrectIcon)\n              }\n            } else {\n              if (correctValues.has(cb.val())) {\n                label.addClass('text-danger').prepend(incorrectIcon)\n              } else {\n                label.addClass('text-muted').prepend(correctIcon)\n              }\n            }\n          })\n        }\n      })\n    }\n  })\n\n  // Default feedback renderer for built-in exercise questions.\n  feedbackRenderer.push({\n    selector: '.examinr-q-exercise',\n    callback: function (question, feedback, grading) {\n      const footer = questionFooter(question)\n      if (grading && footer.children('hr').length === 0) {\n        footer.append('<hr class=\"mb-3 mt-3\" />')\n      }\n\n      const solution = feedback.solution\n      feedback.solution = null\n      renderDefaultFeedback(question, feedback, grading, grading)\n\n      const editor = question.data('editor')\n      if (editor) {\n        if (!grading) {\n          editor.setReadOnly(true)\n        }\n        editor.getSession().setValue(feedback.answer || '\\n')\n      }\n\n      if (!grading) {\n        footer.find('.examinr-run-button').remove()\n        footer.find('.examinr-exercise-status').remove()\n      }\n\n      footer.removeClass('alert alert-danger text-muted')\n      if (solution) {\n        footer.append('<div class=\"examinr-grading-feedback\">' +\n            '<h6>' + exports.status.getMessage('feedback').solutionLabel + '</h6>' +\n            '<pre><code>' + solution + '</code></pre>' +\n          '</div>')\n      }\n    }\n  })\n\n  return {\n    /**\n     * Add default feedback elements to a question.\n     * This renders the points (either as badge for feedback or as input element for grading) and appends\n     * the solution and any comments in the footer.\n     *\n     * @param {jQuery} question question element\n     * @param {Object} feedback feedback object\n     * @param {boolean} grading true if rendering for grading and false for regular (immutable) feedback\n     */\n    renderDefaultFeedback: renderDefaultFeedback,\n\n    /**\n     * Register a function to render the feedback for all questions matching the given selector.\n     * If two functions match the same question, the function registered *later* will be called.\n     *\n     * @param {string} selector a valid jQuery selector query\n     * @param {function} func callback function which will be called with two arguments:\n     *   {jQuery} question the question element\n     *   {Object} the feedback object\n     *   {boolean} true if rendering for grading and false for regular (immutable) feedback\n     */\n    registerFeedbackRenderer: function (selector, func) {\n      feedbackRenderer.unshift({ selector: selector, callback: func })\n    }\n  }\n}())\n","/*\n * Some parts of this file are dervied from the learnr project, which is licensed under the Apache 2.0 license.\n * Original work Copyright 2019 RStudio\n * Derived work Copyright 2020 David Kepplinger\n */\nexports.exercises = (function () {\n  'use strict'\n\n  const kMinLines = 5\n  const kMaxDefaultLines = 20\n  const kThemeMonochrome = 'ace/theme/monochrome'\n  const kThemeDefault = 'ace/theme/textmate'\n\n  let currentTheme = kThemeMonochrome\n  let exerciseRunButtonEnabled = true\n\n  function attachAceEditor (id, code) {\n    const editor = ace.edit(id)\n    editor.setHighlightActiveLine(false)\n    editor.setShowPrintMargin(false)\n    editor.setShowFoldWidgets(false)\n    editor.setBehavioursEnabled(true)\n    editor.renderer.setDisplayIndentGuides(false)\n    editor.setTheme(currentTheme)\n    editor.$blockScrolling = Infinity\n    editor.session.setMode('ace/mode/r')\n    editor.session.getSelection().clearSelection()\n    editor.setValue(code, -1)\n    return editor\n  }\n\n  function exerciseRunning (outputContainer, running) {\n    if (typeof running === 'undefined') {\n      running = !exerciseRunButtonEnabled\n    }\n\n    exports.utils.toggleShim(outputContainer, running)\n    exerciseRunButtonEnabled = (running === false)\n    $('.examinr-run-button').prop('disabled', !exerciseRunButtonEnabled)\n  }\n\n  function initializeExerciseEditor () {\n    const exercise = $(this)\n    const exerciseOptions = JSON.parse(exercise.children('script[type=\"application/json\"]').detach().text() || '{}')\n    let code = ''\n    exercise.children('pre').each(function () {\n      code += $(this).children('code').text() + '\\n'\n    }).remove()\n\n    const codeLines = code.split(/\\r?\\n/).length\n\n    const lines = (exerciseOptions.lines ? Math.max(1, exerciseOptions.lines)\n      : Math.min(Math.max(kMinLines, codeLines), kMaxDefaultLines))\n\n    if (codeLines < lines) {\n      code += '\\n'.repeat(lines - codeLines)\n    }\n\n    const editorId = exerciseOptions.inputId + '-editor'\n    const pointsLabel = exerciseOptions.points\n      ? '<span class=\"examinr-points badge badge-secondary\">' + exerciseOptions.points + '</span>'\n      : ''\n\n    const messageStrings = exports.status.getMessage('exercise') || {}\n\n    const exercisePanel = $('<div class=\"card\">' +\n      '<h6 class=\"card-header\">' + (exerciseOptions.title || '') + pointsLabel + '</h6>' +\n      '<div class=\"card-body\">' +\n        '<div id=\"' + editorId + '\" class=\"examinr-exercise-editor\" role=\"textbox\" contenteditable=\"true\" ' +\n            'aria-multiline=\"true\" tabindex=0 ></div>' +\n      '</div>' +\n      '<div class=\"card-footer text-muted\">' +\n        '<button type=\"button\" class=\"btn btn-secondary btn-sm examinr-run-button float-right\">' +\n          '<span class=\"icon\"><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" class=\"bi bi-play-fill\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\"><path d=\"M11.596 8.697l-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z\"/></svg></span>' +\n          exerciseOptions.buttonLabel +\n        '</button>' +\n        '<div class=\"examinr-exercise-status\">' + messageStrings.notYetRun + '</div>' +\n      '</div>' +\n    '</div>')\n\n    const outputContainer = $('<div class=\"examinr-exercise-output card bg-light\">' +\n      (messageStrings.outputTitle\n        ? ('<div class=\"card-header text-muted small\">' + messageStrings.outputTitle + '</div>')\n        : '') +\n      '<div class=\"card-body p-3\" role=\"status\"></div>' +\n    '</div>')\n    const exerciseEditor = exercise.find('#' + editorId)\n\n    exercise.append(exercisePanel).append(outputContainer)\n\n    // make exercise more accessible\n    exports.accessibility.ariaLabelledBy(exercise, exercisePanel.find('.card-header'))\n    exports.accessibility.ariaAssociate('controls', exercisePanel.find('.examinr-run-button'), outputContainer.find('.card-body'))\n    exerciseEditor.attr('aria-label', exerciseOptions.inputLabel)\n    exerciseEditor.children().attr('aria-hidden', 'true')\n\n    if (!messageStrings.notYetRun) {\n      exercise.find('.examinr-exercise-status').hide()\n    } else {\n      exports.accessibility.ariaDescribedBy(exercisePanel, exercise.find('.examinr-exercise-status'))\n    }\n    exercise.find('.examinr-exercise-output').hide()\n\n    const runCodeButton = exercise.find('.examinr-run-button')\n\n    // Proxy a \"run code\" event through the button to also trigger shiny input events.\n    const triggerClick = function () {\n      runCodeButton.click()\n    }\n\n    const editor = attachAceEditor(editorId, code)\n    editor.setFontSize(0.8125 * parseFloat(exercise.find('.card-body').css('font-size')))\n    editor.commands.addCommand({\n      name: 'run_rcode',\n      bindKey: { win: 'Ctrl+Enter', mac: 'Command+Enter' },\n      exec: triggerClick\n    })\n    editor.commands.addCommand({\n      name: 'run_rcode-shift',\n      bindKey: { win: 'Ctrl+Shift+Enter', mac: 'Command+Shift+Enter' },\n      exec: triggerClick\n    })\n\n    const updateAceHeight = function () {\n      editor.setOptions({\n        minLines: lines,\n        maxLines: lines\n      })\n    }\n    updateAceHeight()\n    editor.getSession().on('change', updateAceHeight)\n\n    runCodeButton.click(function () {\n      editor.focus()\n    })\n\n    exercise.data({\n      editor: editor,\n      options: exerciseOptions\n    })\n\n    exercise.parents('section').on('shown', function () {\n      editor.resize(true)\n    })\n  }\n\n  function initializeEditorBindings () {\n    const inputBindings = new Shiny.InputBinding()\n    $.extend(inputBindings, {\n      find: function (scope) {\n        return $(scope).find('.examinr-exercise')\n      },\n      getId: function (exercise) {\n        return $(exercise).data('options').inputId\n      },\n      subscribe: function (exercise, callback) {\n        exercise = $(exercise)\n        exercise.find('.examinr-run-button').on('click.examinrExerciseInputBinding', function () {\n          if (exerciseRunButtonEnabled) {\n            exercise.data('sendData', true)\n            exerciseRunning(exercise.find('.examinr-exercise-output'), true)\n            callback(true)\n          }\n        })\n      },\n      unsubscribe: function (exercise) {\n        $(exercise).find('.examinr-run-button').off('.examinrExerciseInputBinding')\n      },\n      getValue: function (exercise) {\n        exercise = $(exercise)\n        if (exercise.data('sendData') !== true) {\n          return null\n        }\n        exercise.data('sendData', false)\n        return {\n          label: exercise.data('options').label,\n          code: exercise.data('editor').getSession().getValue(),\n          timestamp: new Date().getTime()\n        }\n      },\n      setValue: function (exercise, value) {\n        $(exercise).data('editor').getSession().setValue(value)\n      }\n    })\n    Shiny.inputBindings.register(inputBindings, 'examinr.exerciseInputBinding')\n\n    const outputBindings = new Shiny.OutputBinding()\n    $.extend(outputBindings, {\n      find: function (scope) {\n        return $(scope).find('.examinr-exercise')\n      },\n      getId: function (exercise) {\n        return $(exercise).data('options').outputId\n      },\n      renderValue: function (exercise, data) {\n        exercise = $(exercise)\n        if (data.result) {\n          const outputContainer = exercise.find('.examinr-exercise-output').show().find('.card-body')\n          outputContainer.html(data.result)\n          outputContainer.find('.kable-table table').addClass('table table-striped table-sm')\n        } else {\n          exercise.find('.examinr-exercise-output').hide()\n        }\n        if (data.status) {\n          const footerClass = (data.status_class && data.status_class !== 'info')\n            ? ('alert-' + data.status_class) : 'text-muted'\n\n          exercise.find('.card-footer')\n            .removeClass('text-muted')\n            .removeClass('alert-success')\n            .removeClass('alert-warning')\n            .removeClass('alert-danger')\n            .addClass(footerClass)\n          exercise.find('.examinr-exercise-status').show().html(data.status)\n        } else {\n          exercise.find('.examinr-exercise-status').hide().html('')\n        }\n        exerciseRunning(exercise.find('.examinr-exercise-output'), false)\n      },\n      renderError: function (exercise, error) {\n        exercise = $(exercise)\n        exerciseRunning(exercise.find('.examinr-exercise-output'), false)\n        exercise.find('.examinr-exercise-output').hide()\n        exercise.find('.examinr-exercise-status').show().text(error.message)\n      },\n      clearError: function (exercise) {\n        exercise = $(exercise)\n        exerciseRunning(exercise.find('.examinr-exercise-output'), false)\n        exercise.find('.examinr-exercise-output').hide()\n        exercise.find('.examinr-exercise-status').hide()\n      }\n    })\n    Shiny.outputBindings.register(outputBindings, 'examinr.exerciseOutputBinding')\n  }\n\n  $(function () {\n    $('.examinr-exercise').each(initializeExerciseEditor)\n    initializeEditorBindings()\n  })\n\n  return {\n    highContrastTheme: function (enabled) {\n      currentTheme = enabled ? kThemeMonochrome : kThemeDefault\n      $('.examinr-exercise').each(function () {\n        const editor = $(this).data('editor')\n        if (editor) {\n          editor.setTheme(currentTheme)\n        }\n      })\n    }\n  }\n}())\n","/*\n * Some parts of this file are dervied from the learnr project, which is licensed under the Apache 2.0 license.\n * Original work Copyright 2019 RStudio\n * Derived work Copyright 2020 David Kepplinger\n */\n(function () {\n  'use strict'\n\n  const kModifierKeyNone = 0\n  const kModifierKeyCtrl = 1\n  const kModifierKeyAlt = 2\n  const kModifierKeyShift = 4\n  const kModifierKeyMeta = 8\n  const kKeycodeTab = 9\n  const kKeycodeSpace = 32\n  var autocompleteTimerId\n  var aceAutocompleteCallback = function () {}\n\n  function modifierCombination (event) {\n    return kModifierKeyNone |\n        (event.ctrlKey ? kModifierKeyCtrl : 0) |\n        (event.altKey ? kModifierKeyAlt : 0) |\n        (event.metaKey ? kModifierKeyMeta : 0) |\n        (event.shiftKey ? kModifierKeyShift : 0)\n  }\n\n  const customRCompleter = {\n    insertMatch: function (editor, data) {\n      // remove prefix\n      const ranges = editor.selection.getAllRanges()\n      const filterLength = editor.completer.completions.filterText.length\n      for (var i = 0; i < ranges.length; i++) {\n        ranges[i].start.column -= filterLength\n        editor.session.remove(ranges[i])\n      }\n\n      // insert completion term (add parentheses for functions)\n      editor.execCommand('insertstring', data.caption)\n\n      // move cursor backwards for functions\n      if (data.is_function) {\n        editor.navigateLeft(1)\n      }\n    }\n  }\n\n  // this message handler is called when new autocomplete results are available.\n  Shiny.addCustomMessageHandler('__.examinr.__-autocomplete', function (suggestions) {\n    const completions = suggestions.map(function (item) {\n      // Items are an array of the form [namespace (str), symbol (str), isFunction (bool)]\n      if (!item || !item[1]) {\n        return null\n      }\n      return {\n        caption: item[1] + (item[2] ? '()' : ''),\n        value: item[1],\n        score: 0,\n        meta: item[0] ? ('{' + item[0] + '}') : '',\n        is_function: item[2],\n        completer: customRCompleter\n      }\n    }).filter(x => x)\n    aceAutocompleteCallback(null, completions)\n  })\n\n  function isPopupOpen (editor) {\n    return editor.completer && editor.completer.popup && editor.completer.popup.isOpen\n  }\n\n  function getCompletions (editor, session, position, _, callback) {\n    // send autocompletion request with all the code up to cursor position\n    // (done to enable multi-line autocompletions)\n    const code = session.getTextRange({\n      start: { row: 0, column: 0 },\n      end: position\n    })\n\n    // If the popup is not open, force a Shiny input event, otherwise only if the code changed.\n    const priority = isPopupOpen(editor) ? 'value' : 'event'\n\n    // this will be called when the Shiny message is received\n    aceAutocompleteCallback = callback\n    // update the input value for the autocomplete input\n    Shiny.setInputValue('__.examinr.__-autocomplete', {\n      code: code,\n      label: editor.exerciseLabel\n    }, { priority: priority })\n  }\n\n  // Initialize autocomplete for the exercise.\n  // Return false if the exercise does not need autocomplete, true otherwise.\n  function initializeExerciseAutocomplete () {\n    const exercise = $(this)\n    if (exercise.data('options').autocomplete !== true) {\n      return\n    }\n\n    // Initialize the editor for autocomplete\n\n    const editor = exercise.data('editor')\n    const exerciseOptions = exercise.data('options')\n\n    const startAutocomplete = function () {\n      editor.execCommand('startAutocomplete')\n    }\n\n    const onChangeCallback = function (data) {\n      // use only a single autocompleter at a time!\n      clearTimeout(autocompleteTimerId)\n\n      data = data || {}\n      if (data.action !== 'insert' || !data.lines || !data.lines.length || data.lines.length > 1) {\n        return\n      }\n      // NOTE: Ace has already updated the document line at this point\n      // so we can just look at the state of that line\n      const pos = editor.getCursorPosition()\n      const line = editor.session.getLine(pos.row)\n\n      // NOTE: we allow new autocompletion sessions following a\n      // ':' insertion just to enable cases where the user is\n      // typing e.g. 'stats::rnorm()' while the popup is visible\n      if (isPopupOpen(editor) && !/::$/.test(line)) {\n        return\n      }\n\n      // figure out appropriate delay -- want to autocomplete\n      // immediately after a '$' or '@' insertion, but need to\n      // execute on timeout to allow Ace to finish processing\n      // events (if any)\n      const delayMs = /[$@]$|::$/.test(line) ? 10 : 300\n      autocompleteTimerId = setTimeout(startAutocomplete, delayMs)\n    }\n\n    editor.on('change', onChangeCallback)\n    editor.on('destroy', function () {\n      editor.off(onChangeCallback)\n    })\n\n    editor.exerciseLabel = exerciseOptions.label\n\n    editor.completers = editor.completers || []\n    editor.completers.push({ getCompletions: getCompletions })\n    editor.setOptions({\n      enableBasicAutocompletion: true,\n      enableLiveAutocompletion: false\n    })\n    editor.keyBinding.addKeyboardHandler({ handleKeyboard: autocompleteKeyboardHandler })\n  }\n\n  function autocompleteKeyboardHandler (data, hash, keyString, keyCode, event) {\n    if (hash !== -1 && data.editor) {\n      const modifierCombo = modifierCombination(event)\n      if ((keyCode === kKeycodeSpace && modifierCombo === kModifierKeyCtrl) ||\n          (keyCode === kKeycodeTab && modifierCombo === kModifierKeyNone &&\n            (!data.editor.completer || !data.editor.completer.activated))) {\n        // cancel any pending autocomplete\n        clearTimeout(autocompleteTimerId)\n        if (isPopupOpen(data.editor)) {\n          data.editor.completer.popup.hide()\n          return { command: 'null' }\n        } else {\n          return { command: 'startAutocomplete' }\n        }\n      }\n    }\n  }\n\n  $(function () {\n    $('.examinr-exercise').each(initializeExerciseAutocomplete)\n  })\n}())\n","exports.sections = (function () {\n  'use strict'\n\n  const recalculatedDelay = 250\n  let currentSectionEl\n  let currentSection = {}\n  let actualSections\n\n  function finishedRecalculating () {\n    exports.utils.toggleShim($('body'), false)\n  }\n\n  Shiny.addCustomMessageHandler('__.examinr.__-sectionChange', function (section) {\n    if (section) {\n      if (section.feedback === true) {\n        // Redirect to the feedback\n        window.location.search = '?display=feedback'\n      }\n\n      if (currentSectionEl && currentSectionEl.length > 0) {\n        currentSectionEl.removeAttr('role').hide()\n      } else if (section.id) {\n        $('section.level1').hide()\n      }\n      currentSection = section\n      currentSectionEl = $('#' + currentSection.id).parent()\n        .show()\n        .attr('role', 'main')\n        .trigger('shown')\n\n      const outputElements = currentSectionEl.find('.shiny-bound-output')\n      let recalculating = outputElements.length\n      if (recalculating > 0) {\n        // Assume that all outputs need to be recalculated.\n        // If not, call finishedRecalculating() after a set delay.\n        let recalculatingTimerId = window.setTimeout(finishedRecalculating, recalculatedDelay)\n        outputElements.one('shiny:recalculated', function () {\n          --recalculating\n          if (recalculating <= 0) {\n            // All outputs have been recalculated.\n            finishedRecalculating()\n          } else {\n            // Some outputs are still to be recalculated. Wait for them a short while, otherwise call\n            // finishedRecalculating()\n            window.clearTimeout(recalculatingTimerId)\n            recalculatingTimerId = window.setTimeout(finishedRecalculating, recalculatedDelay)\n          }\n        })\n      } else {\n        finishedRecalculating()\n      }\n\n      exports.status.resetMessages()\n      if (section.order) {\n        exports.attempt.updateSection(section.order)\n      }\n    }\n  })\n\n  $(function () {\n    const sectionsConfig = JSON.parse($('script.examinr-sections-config').remove().text() || '{}')\n\n    actualSections = $('section.level1')\n    // Add the correct label to each section\n    actualSections.each(function () {\n      const el = $(this)\n      exports.accessibility.ariaLabelledBy(el, el.children('h1'))\n    })\n\n    $('.examinr-section-next').click(function () {\n      exports.utils.toggleShim($('body'), true)\n    })\n\n    if (!sectionsConfig.progressive) {\n      // All-at-once exam. Show the \"next button\" only for the last real section.\n      $('.examinr-section-next').hide()\n      exports.accessibility.ariaLabelledBy($('main'), $('h1.title'))\n\n      // hide the last section (used for final remarks)\n      if (sectionsConfig.hideLastSection) {\n        actualSections.last().hide()\n        actualSections = actualSections.slice(0, -1)\n        actualSections.last().find('.examinr-section-next').show()\n      }\n    } else {\n      // progressive exams: hide all sections\n      actualSections.hide()\n      if (sectionsConfig.hideLastSection) {\n        $('section.level1:last .examinr-section-next').remove()\n        actualSections = actualSections.slice(0, -1)\n      }\n    }\n  })\n\n  return {\n    showAll: function () {\n      actualSections.show().trigger('shown')\n    }\n  }\n}())\n","exports.grading = (function () {\n  'use strict'\n\n  function updateGrading (question, gradingData) {\n    // Save locally\n    question.data('gradingData', gradingData)\n\n    // And remotely\n    if (!gradingData.feedbackShown) {\n      gradingData.feedback = null\n    }\n    Shiny.setInputValue('__.examinr.__-gradingData', gradingData)\n  }\n\n  function toggleFeedback () {\n    const btn = $(this)\n    const question = btn.parents('.examinr-question')\n    const gradingData = question.data('grading') || {}\n    if (gradingData.feedbackShown) {\n      btn.children('.btn-label').text('+')\n      btn.children('.sr-only').text('Add comment')\n      question.data('feedbackShown', false)\n        .find('.examinr-grading-feedback')\n        .remove()\n    } else {\n      btn.children('.btn-label').html('&times;')\n      btn.children('.sr-only').text('Remove comment')\n      let footer = question.find('.card-footer')\n      if (footer.length === 0) {\n        footer = $('<div class=\"card-footer\">')\n        footer.appendTo(question.hasClass('card') ? question : question.find('.card'))\n      }\n      question.data('feedbackShown', true)\n\n      const commentInputId = exports.utils.randomId('comment-')\n\n      footer.append(\n        '<div class=\"input-group examinr-grading-feedback\">' +\n          '<div class=\"input-group-prepend\">' +\n            '<label class=\"input-group-text\" for=\"' + commentInputId + '\">' +\n              exports.status.getMessage('feedback').commentLabel +\n            '</label>' +\n          '</div>' +\n          '<textarea class=\"form-control\" id=\"' + commentInputId + '\">' +\n            (gradingData.feedback || '') +\n          '</textarea>' +\n        '</div>')\n\n      question.find('.examinr-grading-feedback textarea').on('change', function () {\n        const gradingData = question.data('grading') || {}\n        gradingData.feedback = $(this).val()\n        updateGrading(question, gradingData)\n      })\n    }\n    gradingData.feedbackShown = !gradingData.feedbackShown\n    updateGrading(question, gradingData)\n  }\n\n  function prepareQuestion () {\n    const question = $(this)\n    const gradingData = question.data('grading') || {}\n    const pointsEl = question.find('.examinr-points')\n    const container = pointsEl.parent()\n    const placeholder = pointsEl.remove().text()\n\n    if (!gradingData.maxPoints) {\n      gradingData.maxPoints = parseFloat(question.data('maxPoints')) || 1\n    }\n\n    const pointsInput = $('<input type=\"number\" class=\"form-control\" />')\n      .attr('max', gradingData.maxPoints)\n      .attr('id', exports.utils.randomId())\n\n    const feedbackBtn = gradingData.feedbackShown ? '&times;' : '+'\n    const feedbackLabel = gradingData.feedbackShown ? 'Remove feedback' : 'Add feedback'\n\n    container.addClass('clearfix')\n      .append('<div class=\"input-group input-group-sm examinr-points\">' +\n        '<label class=\"sr-only\" for=\"' + pointsInput.attr('id') + '\">Points</label>' +\n        '<div class=\"input-group-append\">' +\n          '<span class=\"input-group-text\">/ ' + placeholder + '</span>' +\n          '<button type=\"button\" class=\"btn btn-secondary\">' +\n            '<span class=\"btn-label\" aria-hidden=\"true\">' + feedbackBtn + '</span>' +\n            '<span class=\"sr-only\">' + feedbackLabel + '</span>' +\n          '</button>' +\n        '</div>' +\n      '</div>')\n      .find('.input-group')\n      .prepend(pointsInput)\n\n    question.data('grading', gradingData)\n    container.find('.btn').click(toggleFeedback)\n    exports.utils.disableNumberInputDefaults(pointsInput)\n  }\n\n  function startGrading () {\n    exports.status.disableProgress()\n    const statusContainer = exports.status.statusContainer()\n\n    const studentNameInputId = exports.utils.randomId('student-name')\n    const attemptInputId = exports.utils.randomId('attempt')\n\n    statusContainer.append(\n      '<form class=\"form-inline examinr-grading-attempt\">' +\n        '<div class=\"input-group input-group-sm\">' +\n          '<div class=\"input-group-prepend\">' +\n            '<button class=\"btn btn-secondary\" type=\"button\">' +\n              '<span aria-hidden=\"true\">&lt;</span>' +\n              '<span class=\"sr-only\">Previous student</span>' +\n            '</button>' +\n          '</div>' +\n          '<label class=\"sr-only\" for=\"' + studentNameInputId + '\">Student</label>' +\n          '<input type=\"text\" id=\"' + studentNameInputId + '\" class=\"form-control\" placeholder=\"Student\" />' +\n          '<span class=\"input-group-append\">' +\n            '<button class=\"btn btn-secondary\" type=\"button\">' +\n              '<span aria-hidden=\"true\">&gt;</span>' +\n              '<span class=\"sr-only\">Next Student</span>' +\n            '</button>' +\n          '</span>' +\n        '</div>' +\n        '<div class=\"input-group input-group-sm\">' +\n          '<label class=\"sr-only\" for=\"' + attemptInputId + '\">Attempt</label>' +\n          '<select id=\"' + attemptInputId + '\" class=\"form-control\" disabled></select>' +\n        '</div>' +\n      '</form>'\n    )\n\n    exports.status.fixMainOffset()\n\n    // Prepare the questions\n    $('.examinr-question').each(prepareQuestion)\n  }\n\n  return {\n    startGrading: startGrading\n  }\n}())\n","ace.define('ace/theme/monochrome', ['require', 'exports', 'module', 'ace/lib/dom'], function (acequire, exports, module) {\n  exports.isDark = false\n  exports.cssClass = 'ace-monochrome'\n  exports.cssText = '.ace-monochrome .ace_gutter{background:#000;color:#fff}.ace-monochrome.ace_print-margin{width:2px;background:#999}.ace-monochrome .ace_editor{background-color:#fff;color:#000}.ace-monochrome .ace_cursor{color:#000;border:0;border-right:0;border-left:.5em solid #000}.ace-monochrome .ace_marker-layer .ace_selection{background:#777}.ace-monochrome.ace_multiselect .ace_selection.ace_start{border-radius:2px}.ace-monochrome .ace_marker-layer .ace_step{background:#000}.ace-monochrome .ace_marker-layer .ace_bracket{margin:0;border:2px solid #d55e00}.ace-monochrome .ace_marker-layer .ace_active-line{background:transparent;border:2px solid #d55e00}.ace-monochrome .ace_gutter-active-line{background:#000}.ace-monochrome .ace_marker-layer .ace_selected-word{border:2px dashed #d55e00}.ace-monochrome .ace_invisible{color:#fff}.ace-monochrome .ace_comment,.ace-monochrome .ace_constant.ace_language{font-style:italic;color:#444}.ace-monochrome .ace_indent-guide{background:url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWPQ0FD0ZXBzd/wPAAjVAoxeSgNeAAAAAElFTkSuQmCC\") right repeat-y}.ace_layer{z-index:3}.ace_layer.ace_print-margin-layer{z-index:2}.ace_layer.ace_marker-layer{z-index:1}.ace_editor.ace_autocomplete{background:#ccc;border:solid 2px #000 !important;color:#000}.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line,.ace_editor.ace_autocomplete .ace_marker-layer .ace_line-hover{background:#fff;border:0;border:2px dashed #d55e00}'\n  var dom = acequire('../lib/dom')\n  dom.importCssString(exports.cssText, exports.cssClass)\n})\n","/**\n * --------------------------------------------------------------------------\n * Bootstrap (v4.5.3): util.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport $ from 'jquery'\n\n/**\n * ------------------------------------------------------------------------\n * Private TransitionEnd Helpers\n * ------------------------------------------------------------------------\n */\n\nconst TRANSITION_END = 'transitionend'\nconst MAX_UID = 1000000\nconst MILLISECONDS_MULTIPLIER = 1000\n\n// Shoutout AngusCroll (https://goo.gl/pxwQGp)\nfunction toType(obj) {\n  if (obj === null || typeof obj === 'undefined') {\n    return `${obj}`\n  }\n\n  return {}.toString.call(obj).match(/\\s([a-z]+)/i)[1].toLowerCase()\n}\n\nfunction getSpecialTransitionEndEvent() {\n  return {\n    bindType: TRANSITION_END,\n    delegateType: TRANSITION_END,\n    handle(event) {\n      if ($(event.target).is(this)) {\n        return event.handleObj.handler.apply(this, arguments) // eslint-disable-line prefer-rest-params\n      }\n\n      return undefined\n    }\n  }\n}\n\nfunction transitionEndEmulator(duration) {\n  let called = false\n\n  $(this).one(Util.TRANSITION_END, () => {\n    called = true\n  })\n\n  setTimeout(() => {\n    if (!called) {\n      Util.triggerTransitionEnd(this)\n    }\n  }, duration)\n\n  return this\n}\n\nfunction setTransitionEndSupport() {\n  $.fn.emulateTransitionEnd = transitionEndEmulator\n  $.event.special[Util.TRANSITION_END] = getSpecialTransitionEndEvent()\n}\n\n/**\n * --------------------------------------------------------------------------\n * Public Util Api\n * --------------------------------------------------------------------------\n */\n\nconst Util = {\n  TRANSITION_END: 'bsTransitionEnd',\n\n  getUID(prefix) {\n    do {\n      prefix += ~~(Math.random() * MAX_UID) // \"~~\" acts like a faster Math.floor() here\n    } while (document.getElementById(prefix))\n\n    return prefix\n  },\n\n  getSelectorFromElement(element) {\n    let selector = element.getAttribute('data-target')\n\n    if (!selector || selector === '#') {\n      const hrefAttr = element.getAttribute('href')\n      selector = hrefAttr && hrefAttr !== '#' ? hrefAttr.trim() : ''\n    }\n\n    try {\n      return document.querySelector(selector) ? selector : null\n    } catch (_) {\n      return null\n    }\n  },\n\n  getTransitionDurationFromElement(element) {\n    if (!element) {\n      return 0\n    }\n\n    // Get transition-duration of the element\n    let transitionDuration = $(element).css('transition-duration')\n    let transitionDelay = $(element).css('transition-delay')\n\n    const floatTransitionDuration = parseFloat(transitionDuration)\n    const floatTransitionDelay = parseFloat(transitionDelay)\n\n    // Return 0 if element or transition duration is not found\n    if (!floatTransitionDuration && !floatTransitionDelay) {\n      return 0\n    }\n\n    // If multiple durations are defined, take the first\n    transitionDuration = transitionDuration.split(',')[0]\n    transitionDelay = transitionDelay.split(',')[0]\n\n    return (parseFloat(transitionDuration) + parseFloat(transitionDelay)) * MILLISECONDS_MULTIPLIER\n  },\n\n  reflow(element) {\n    return element.offsetHeight\n  },\n\n  triggerTransitionEnd(element) {\n    $(element).trigger(TRANSITION_END)\n  },\n\n  supportsTransitionEnd() {\n    return Boolean(TRANSITION_END)\n  },\n\n  isElement(obj) {\n    return (obj[0] || obj).nodeType\n  },\n\n  typeCheckConfig(componentName, config, configTypes) {\n    for (const property in configTypes) {\n      if (Object.prototype.hasOwnProperty.call(configTypes, property)) {\n        const expectedTypes = configTypes[property]\n        const value = config[property]\n        const valueType = value && Util.isElement(value) ?\n          'element' : toType(value)\n\n        if (!new RegExp(expectedTypes).test(valueType)) {\n          throw new Error(\n            `${componentName.toUpperCase()}: ` +\n            `Option \"${property}\" provided type \"${valueType}\" ` +\n            `but expected type \"${expectedTypes}\".`)\n        }\n      }\n    }\n  },\n\n  findShadowRoot(element) {\n    if (!document.documentElement.attachShadow) {\n      return null\n    }\n\n    // Can find the shadow root otherwise it'll return the document\n    if (typeof element.getRootNode === 'function') {\n      const root = element.getRootNode()\n      return root instanceof ShadowRoot ? root : null\n    }\n\n    if (element instanceof ShadowRoot) {\n      return element\n    }\n\n    // when we don't find a shadow root\n    if (!element.parentNode) {\n      return null\n    }\n\n    return Util.findShadowRoot(element.parentNode)\n  },\n\n  jQueryDetection() {\n    if (typeof $ === 'undefined') {\n      throw new TypeError('Bootstrap\\'s JavaScript requires jQuery. jQuery must be included before Bootstrap\\'s JavaScript.')\n    }\n\n    const version = $.fn.jquery.split(' ')[0].split('.')\n    const minMajor = 1\n    const ltMajor = 2\n    const minMinor = 9\n    const minPatch = 1\n    const maxMajor = 4\n\n    if (version[0] < ltMajor && version[1] < minMinor || version[0] === minMajor && version[1] === minMinor && version[2] < minPatch || version[0] >= maxMajor) {\n      throw new Error('Bootstrap\\'s JavaScript requires at least jQuery v1.9.1 but less than v4.0.0')\n    }\n  }\n}\n\nUtil.jQueryDetection()\nsetTransitionEndSupport()\n\nexport default Util\n","/**\n * --------------------------------------------------------------------------\n * Bootstrap (v4.5.3): modal.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport $ from 'jquery'\nimport Util from './util'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'modal'\nconst VERSION = '4.5.3'\nconst DATA_KEY = 'bs.modal'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\nconst JQUERY_NO_CONFLICT = $.fn[NAME]\nconst ESCAPE_KEYCODE = 27 // KeyboardEvent.which value for Escape (Esc) key\n\nconst Default = {\n  backdrop: true,\n  keyboard: true,\n  focus: true,\n  show: true\n}\n\nconst DefaultType = {\n  backdrop: '(boolean|string)',\n  keyboard: 'boolean',\n  focus: 'boolean',\n  show: 'boolean'\n}\n\nconst EVENT_HIDE = `hide${EVENT_KEY}`\nconst EVENT_HIDE_PREVENTED = `hidePrevented${EVENT_KEY}`\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\nconst EVENT_SHOW = `show${EVENT_KEY}`\nconst EVENT_SHOWN = `shown${EVENT_KEY}`\nconst EVENT_FOCUSIN = `focusin${EVENT_KEY}`\nconst EVENT_RESIZE = `resize${EVENT_KEY}`\nconst EVENT_CLICK_DISMISS = `click.dismiss${EVENT_KEY}`\nconst EVENT_KEYDOWN_DISMISS = `keydown.dismiss${EVENT_KEY}`\nconst EVENT_MOUSEUP_DISMISS = `mouseup.dismiss${EVENT_KEY}`\nconst EVENT_MOUSEDOWN_DISMISS = `mousedown.dismiss${EVENT_KEY}`\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\n\nconst CLASS_NAME_SCROLLABLE = 'modal-dialog-scrollable'\nconst CLASS_NAME_SCROLLBAR_MEASURER = 'modal-scrollbar-measure'\nconst CLASS_NAME_BACKDROP = 'modal-backdrop'\nconst CLASS_NAME_OPEN = 'modal-open'\nconst CLASS_NAME_FADE = 'fade'\nconst CLASS_NAME_SHOW = 'show'\nconst CLASS_NAME_STATIC = 'modal-static'\n\nconst SELECTOR_DIALOG = '.modal-dialog'\nconst SELECTOR_MODAL_BODY = '.modal-body'\nconst SELECTOR_DATA_TOGGLE = '[data-toggle=\"modal\"]'\nconst SELECTOR_DATA_DISMISS = '[data-dismiss=\"modal\"]'\nconst SELECTOR_FIXED_CONTENT = '.fixed-top, .fixed-bottom, .is-fixed, .sticky-top'\nconst SELECTOR_STICKY_CONTENT = '.sticky-top'\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass Modal {\n  constructor(element, config) {\n    this._config = this._getConfig(config)\n    this._element = element\n    this._dialog = element.querySelector(SELECTOR_DIALOG)\n    this._backdrop = null\n    this._isShown = false\n    this._isBodyOverflowing = false\n    this._ignoreBackdropClick = false\n    this._isTransitioning = false\n    this._scrollbarWidth = 0\n  }\n\n  // Getters\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  static get Default() {\n    return Default\n  }\n\n  // Public\n\n  toggle(relatedTarget) {\n    return this._isShown ? this.hide() : this.show(relatedTarget)\n  }\n\n  show(relatedTarget) {\n    if (this._isShown || this._isTransitioning) {\n      return\n    }\n\n    if ($(this._element).hasClass(CLASS_NAME_FADE)) {\n      this._isTransitioning = true\n    }\n\n    const showEvent = $.Event(EVENT_SHOW, {\n      relatedTarget\n    })\n\n    $(this._element).trigger(showEvent)\n\n    if (this._isShown || showEvent.isDefaultPrevented()) {\n      return\n    }\n\n    this._isShown = true\n\n    this._checkScrollbar()\n    this._setScrollbar()\n\n    this._adjustDialog()\n\n    this._setEscapeEvent()\n    this._setResizeEvent()\n\n    $(this._element).on(\n      EVENT_CLICK_DISMISS,\n      SELECTOR_DATA_DISMISS,\n      event => this.hide(event)\n    )\n\n    $(this._dialog).on(EVENT_MOUSEDOWN_DISMISS, () => {\n      $(this._element).one(EVENT_MOUSEUP_DISMISS, event => {\n        if ($(event.target).is(this._element)) {\n          this._ignoreBackdropClick = true\n        }\n      })\n    })\n\n    this._showBackdrop(() => this._showElement(relatedTarget))\n  }\n\n  hide(event) {\n    if (event) {\n      event.preventDefault()\n    }\n\n    if (!this._isShown || this._isTransitioning) {\n      return\n    }\n\n    const hideEvent = $.Event(EVENT_HIDE)\n\n    $(this._element).trigger(hideEvent)\n\n    if (!this._isShown || hideEvent.isDefaultPrevented()) {\n      return\n    }\n\n    this._isShown = false\n    const transition = $(this._element).hasClass(CLASS_NAME_FADE)\n\n    if (transition) {\n      this._isTransitioning = true\n    }\n\n    this._setEscapeEvent()\n    this._setResizeEvent()\n\n    $(document).off(EVENT_FOCUSIN)\n\n    $(this._element).removeClass(CLASS_NAME_SHOW)\n\n    $(this._element).off(EVENT_CLICK_DISMISS)\n    $(this._dialog).off(EVENT_MOUSEDOWN_DISMISS)\n\n    if (transition) {\n      const transitionDuration = Util.getTransitionDurationFromElement(this._element)\n\n      $(this._element)\n        .one(Util.TRANSITION_END, event => this._hideModal(event))\n        .emulateTransitionEnd(transitionDuration)\n    } else {\n      this._hideModal()\n    }\n  }\n\n  dispose() {\n    [window, this._element, this._dialog]\n      .forEach(htmlElement => $(htmlElement).off(EVENT_KEY))\n\n    /**\n     * `document` has 2 events `EVENT_FOCUSIN` and `EVENT_CLICK_DATA_API`\n     * Do not move `document` in `htmlElements` array\n     * It will remove `EVENT_CLICK_DATA_API` event that should remain\n     */\n    $(document).off(EVENT_FOCUSIN)\n\n    $.removeData(this._element, DATA_KEY)\n\n    this._config = null\n    this._element = null\n    this._dialog = null\n    this._backdrop = null\n    this._isShown = null\n    this._isBodyOverflowing = null\n    this._ignoreBackdropClick = null\n    this._isTransitioning = null\n    this._scrollbarWidth = null\n  }\n\n  handleUpdate() {\n    this._adjustDialog()\n  }\n\n  // Private\n\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...config\n    }\n    Util.typeCheckConfig(NAME, config, DefaultType)\n    return config\n  }\n\n  _triggerBackdropTransition() {\n    if (this._config.backdrop === 'static') {\n      const hideEventPrevented = $.Event(EVENT_HIDE_PREVENTED)\n\n      $(this._element).trigger(hideEventPrevented)\n      if (hideEventPrevented.isDefaultPrevented()) {\n        return\n      }\n\n      const isModalOverflowing = this._element.scrollHeight > document.documentElement.clientHeight\n\n      if (!isModalOverflowing) {\n        this._element.style.overflowY = 'hidden'\n      }\n\n      this._element.classList.add(CLASS_NAME_STATIC)\n\n      const modalTransitionDuration = Util.getTransitionDurationFromElement(this._dialog)\n      $(this._element).off(Util.TRANSITION_END)\n\n      $(this._element).one(Util.TRANSITION_END, () => {\n        this._element.classList.remove(CLASS_NAME_STATIC)\n        if (!isModalOverflowing) {\n          $(this._element).one(Util.TRANSITION_END, () => {\n            this._element.style.overflowY = ''\n          })\n            .emulateTransitionEnd(this._element, modalTransitionDuration)\n        }\n      })\n        .emulateTransitionEnd(modalTransitionDuration)\n      this._element.focus()\n    } else {\n      this.hide()\n    }\n  }\n\n  _showElement(relatedTarget) {\n    const transition = $(this._element).hasClass(CLASS_NAME_FADE)\n    const modalBody = this._dialog ? this._dialog.querySelector(SELECTOR_MODAL_BODY) : null\n\n    if (!this._element.parentNode ||\n        this._element.parentNode.nodeType !== Node.ELEMENT_NODE) {\n      // Don't move modal's DOM position\n      document.body.appendChild(this._element)\n    }\n\n    this._element.style.display = 'block'\n    this._element.removeAttribute('aria-hidden')\n    this._element.setAttribute('aria-modal', true)\n    this._element.setAttribute('role', 'dialog')\n\n    if ($(this._dialog).hasClass(CLASS_NAME_SCROLLABLE) && modalBody) {\n      modalBody.scrollTop = 0\n    } else {\n      this._element.scrollTop = 0\n    }\n\n    if (transition) {\n      Util.reflow(this._element)\n    }\n\n    $(this._element).addClass(CLASS_NAME_SHOW)\n\n    if (this._config.focus) {\n      this._enforceFocus()\n    }\n\n    const shownEvent = $.Event(EVENT_SHOWN, {\n      relatedTarget\n    })\n\n    const transitionComplete = () => {\n      if (this._config.focus) {\n        this._element.focus()\n      }\n\n      this._isTransitioning = false\n      $(this._element).trigger(shownEvent)\n    }\n\n    if (transition) {\n      const transitionDuration = Util.getTransitionDurationFromElement(this._dialog)\n\n      $(this._dialog)\n        .one(Util.TRANSITION_END, transitionComplete)\n        .emulateTransitionEnd(transitionDuration)\n    } else {\n      transitionComplete()\n    }\n  }\n\n  _enforceFocus() {\n    $(document)\n      .off(EVENT_FOCUSIN) // Guard against infinite focus loop\n      .on(EVENT_FOCUSIN, event => {\n        if (document !== event.target &&\n            this._element !== event.target &&\n            $(this._element).has(event.target).length === 0) {\n          this._element.focus()\n        }\n      })\n  }\n\n  _setEscapeEvent() {\n    if (this._isShown) {\n      $(this._element).on(EVENT_KEYDOWN_DISMISS, event => {\n        if (this._config.keyboard && event.which === ESCAPE_KEYCODE) {\n          event.preventDefault()\n          this.hide()\n        } else if (!this._config.keyboard && event.which === ESCAPE_KEYCODE) {\n          this._triggerBackdropTransition()\n        }\n      })\n    } else if (!this._isShown) {\n      $(this._element).off(EVENT_KEYDOWN_DISMISS)\n    }\n  }\n\n  _setResizeEvent() {\n    if (this._isShown) {\n      $(window).on(EVENT_RESIZE, event => this.handleUpdate(event))\n    } else {\n      $(window).off(EVENT_RESIZE)\n    }\n  }\n\n  _hideModal() {\n    this._element.style.display = 'none'\n    this._element.setAttribute('aria-hidden', true)\n    this._element.removeAttribute('aria-modal')\n    this._element.removeAttribute('role')\n    this._isTransitioning = false\n    this._showBackdrop(() => {\n      $(document.body).removeClass(CLASS_NAME_OPEN)\n      this._resetAdjustments()\n      this._resetScrollbar()\n      $(this._element).trigger(EVENT_HIDDEN)\n    })\n  }\n\n  _removeBackdrop() {\n    if (this._backdrop) {\n      $(this._backdrop).remove()\n      this._backdrop = null\n    }\n  }\n\n  _showBackdrop(callback) {\n    const animate = $(this._element).hasClass(CLASS_NAME_FADE) ?\n      CLASS_NAME_FADE : ''\n\n    if (this._isShown && this._config.backdrop) {\n      this._backdrop = document.createElement('div')\n      this._backdrop.className = CLASS_NAME_BACKDROP\n\n      if (animate) {\n        this._backdrop.classList.add(animate)\n      }\n\n      $(this._backdrop).appendTo(document.body)\n\n      $(this._element).on(EVENT_CLICK_DISMISS, event => {\n        if (this._ignoreBackdropClick) {\n          this._ignoreBackdropClick = false\n          return\n        }\n\n        if (event.target !== event.currentTarget) {\n          return\n        }\n\n        this._triggerBackdropTransition()\n      })\n\n      if (animate) {\n        Util.reflow(this._backdrop)\n      }\n\n      $(this._backdrop).addClass(CLASS_NAME_SHOW)\n\n      if (!callback) {\n        return\n      }\n\n      if (!animate) {\n        callback()\n        return\n      }\n\n      const backdropTransitionDuration = Util.getTransitionDurationFromElement(this._backdrop)\n\n      $(this._backdrop)\n        .one(Util.TRANSITION_END, callback)\n        .emulateTransitionEnd(backdropTransitionDuration)\n    } else if (!this._isShown && this._backdrop) {\n      $(this._backdrop).removeClass(CLASS_NAME_SHOW)\n\n      const callbackRemove = () => {\n        this._removeBackdrop()\n        if (callback) {\n          callback()\n        }\n      }\n\n      if ($(this._element).hasClass(CLASS_NAME_FADE)) {\n        const backdropTransitionDuration = Util.getTransitionDurationFromElement(this._backdrop)\n\n        $(this._backdrop)\n          .one(Util.TRANSITION_END, callbackRemove)\n          .emulateTransitionEnd(backdropTransitionDuration)\n      } else {\n        callbackRemove()\n      }\n    } else if (callback) {\n      callback()\n    }\n  }\n\n  // ----------------------------------------------------------------------\n  // the following methods are used to handle overflowing modals\n  // todo (fat): these should probably be refactored out of modal.js\n  // ----------------------------------------------------------------------\n\n  _adjustDialog() {\n    const isModalOverflowing = this._element.scrollHeight > document.documentElement.clientHeight\n\n    if (!this._isBodyOverflowing && isModalOverflowing) {\n      this._element.style.paddingLeft = `${this._scrollbarWidth}px`\n    }\n\n    if (this._isBodyOverflowing && !isModalOverflowing) {\n      this._element.style.paddingRight = `${this._scrollbarWidth}px`\n    }\n  }\n\n  _resetAdjustments() {\n    this._element.style.paddingLeft = ''\n    this._element.style.paddingRight = ''\n  }\n\n  _checkScrollbar() {\n    const rect = document.body.getBoundingClientRect()\n    this._isBodyOverflowing = Math.round(rect.left + rect.right) < window.innerWidth\n    this._scrollbarWidth = this._getScrollbarWidth()\n  }\n\n  _setScrollbar() {\n    if (this._isBodyOverflowing) {\n      // Note: DOMNode.style.paddingRight returns the actual value or '' if not set\n      //   while $(DOMNode).css('padding-right') returns the calculated value or 0 if not set\n      const fixedContent = [].slice.call(document.querySelectorAll(SELECTOR_FIXED_CONTENT))\n      const stickyContent = [].slice.call(document.querySelectorAll(SELECTOR_STICKY_CONTENT))\n\n      // Adjust fixed content padding\n      $(fixedContent).each((index, element) => {\n        const actualPadding = element.style.paddingRight\n        const calculatedPadding = $(element).css('padding-right')\n        $(element)\n          .data('padding-right', actualPadding)\n          .css('padding-right', `${parseFloat(calculatedPadding) + this._scrollbarWidth}px`)\n      })\n\n      // Adjust sticky content margin\n      $(stickyContent).each((index, element) => {\n        const actualMargin = element.style.marginRight\n        const calculatedMargin = $(element).css('margin-right')\n        $(element)\n          .data('margin-right', actualMargin)\n          .css('margin-right', `${parseFloat(calculatedMargin) - this._scrollbarWidth}px`)\n      })\n\n      // Adjust body padding\n      const actualPadding = document.body.style.paddingRight\n      const calculatedPadding = $(document.body).css('padding-right')\n      $(document.body)\n        .data('padding-right', actualPadding)\n        .css('padding-right', `${parseFloat(calculatedPadding) + this._scrollbarWidth}px`)\n    }\n\n    $(document.body).addClass(CLASS_NAME_OPEN)\n  }\n\n  _resetScrollbar() {\n    // Restore fixed content padding\n    const fixedContent = [].slice.call(document.querySelectorAll(SELECTOR_FIXED_CONTENT))\n    $(fixedContent).each((index, element) => {\n      const padding = $(element).data('padding-right')\n      $(element).removeData('padding-right')\n      element.style.paddingRight = padding ? padding : ''\n    })\n\n    // Restore sticky content\n    const elements = [].slice.call(document.querySelectorAll(`${SELECTOR_STICKY_CONTENT}`))\n    $(elements).each((index, element) => {\n      const margin = $(element).data('margin-right')\n      if (typeof margin !== 'undefined') {\n        $(element).css('margin-right', margin).removeData('margin-right')\n      }\n    })\n\n    // Restore body padding\n    const padding = $(document.body).data('padding-right')\n    $(document.body).removeData('padding-right')\n    document.body.style.paddingRight = padding ? padding : ''\n  }\n\n  _getScrollbarWidth() { // thx d.walsh\n    const scrollDiv = document.createElement('div')\n    scrollDiv.className = CLASS_NAME_SCROLLBAR_MEASURER\n    document.body.appendChild(scrollDiv)\n    const scrollbarWidth = scrollDiv.getBoundingClientRect().width - scrollDiv.clientWidth\n    document.body.removeChild(scrollDiv)\n    return scrollbarWidth\n  }\n\n  // Static\n\n  static _jQueryInterface(config, relatedTarget) {\n    return this.each(function () {\n      let data = $(this).data(DATA_KEY)\n      const _config = {\n        ...Default,\n        ...$(this).data(),\n        ...(typeof config === 'object' && config ? config : {})\n      }\n\n      if (!data) {\n        data = new Modal(this, _config)\n        $(this).data(DATA_KEY, data)\n      }\n\n      if (typeof config === 'string') {\n        if (typeof data[config] === 'undefined') {\n          throw new TypeError(`No method named \"${config}\"`)\n        }\n\n        data[config](relatedTarget)\n      } else if (_config.show) {\n        data.show(relatedTarget)\n      }\n    })\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\n$(document).on(EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\n  let target\n  const selector = Util.getSelectorFromElement(this)\n\n  if (selector) {\n    target = document.querySelector(selector)\n  }\n\n  const config = $(target).data(DATA_KEY) ?\n    'toggle' : {\n      ...$(target).data(),\n      ...$(this).data()\n    }\n\n  if (this.tagName === 'A' || this.tagName === 'AREA') {\n    event.preventDefault()\n  }\n\n  const $target = $(target).one(EVENT_SHOW, showEvent => {\n    if (showEvent.isDefaultPrevented()) {\n      // Only register focus restorer if modal will actually get shown\n      return\n    }\n\n    $target.one(EVENT_HIDDEN, () => {\n      if ($(this).is(':visible')) {\n        this.focus()\n      }\n    })\n  })\n\n  Modal._jQueryInterface.call($(target), config, this)\n})\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n\n$.fn[NAME] = Modal._jQueryInterface\n$.fn[NAME].Constructor = Modal\n$.fn[NAME].noConflict = () => {\n  $.fn[NAME] = JQUERY_NO_CONFLICT\n  return Modal._jQueryInterface\n}\n\nexport default Modal\n"]}