/*! examinr 0.1.0 | (c) 2020-2020 David Kepplinger | License: MIT + file LICENSE */

"use strict";window.Exam=function(){function a(a,b){var c=ace.edit(a);return c.setHighlightActiveLine(!1),c.setShowPrintMargin(!1),c.setShowFoldWidgets(!1),c.setBehavioursEnabled(!0),c.renderer.setDisplayIndentGuides(!1),c.setTheme("ace/theme/textmate"),c.$blockScrolling=1/0,c.session.setMode("ace/mode/r"),c.session.getSelection().clearSelection(),c.setValue(b,-1),c}function b(a,b){a=a?$(a):$("body");var c=a.children(".examinr-recompute-overlay");if(void 0===b&&(b=0===c.length),!1===b)c.remove(),a.removeClass("examinr-recompute-outer");else{c=$('<div class="examinr-recompute-overlay"><div class="examinr-recompute"></div></div>'),a.prepend(c);var d=c.offsetParent();d.length>0&&d.get(0)!==a.get(0)&&a.addClass("examinr-recompute-outer"),a.show()}}function c(a,c){void 0===c&&(c=!h),b(a,c),h=!1===c,$(".examinr-run-button").prop("disabled",!h)}function d(){$(".examinr-exercise").each(function(){var b=$(this),c=JSON.parse(b.children('script[type="application/json"]').detach().text()||"{}"),d="";b.children("pre").each(function(){d+=$(this).children("code").text()+"\n"}).remove();var e=d.split(/\r?\n/).length,h=c.lines?Math.max(1,c.lines):Math.min(Math.max(f,e),g);e<h&&(d+="\n".repeat(h-e));var i=c.input_id+"-editor",j=c.points?'<span class="label '+(c.label_class||"")+'">'+c.points+"</span>":"";b.append('<div class="panel '+(c.panel_class||"")+'"><div class="panel-heading"><button type="button" class="btn '+(c.button_class||"")+' btn-xs examinr-run-button pull-right"><span class="glyphicon glyphicon-play"></span>'+(c.button||"")+'</button><h5 class="panel-title">'+(c.title||"")+j+'</h5></div><div class="panel-body"><div id="'+i+'" class="examinr-exercise-editor"></div></div><div class="panel-footer"><div class="small alert alert-warning examinr-exercise-status">'+(c.status_messages.notrun||"")+'</div></div></div><div class="examinr-exercise-output well"></div>'),c.status_messages.notrun||b.find(".examinr-exercise-status").hide(),b.find(".examinr-exercise-output").hide();var k=b.find(".examinr-run-button"),l=function(){k.click()},m=a(i,d);m.setFontSize(.8125*parseFloat(b.find(".panel-body").css("font-size"))),m.commands.addCommand({name:"run_rcode",bindKey:{win:"Ctrl+Enter",mac:"Command+Enter"},exec:l}),m.commands.addCommand({name:"run_rcode-shift",bindKey:{win:"Ctrl+Shift+Enter",mac:"Command+Shift+Enter"},exec:l});var n=function(){m.setOptions({minLines:h,maxLines:h})};n(),m.getSession().on("change",n),k.click(function(){m.focus()}),b.data({editor:m,options:c})})}function e(){var a=new Shiny.InputBinding;$.extend(a,{find:function(a){return $(a).find(".examinr-exercise")},getId:function(a){return $(a).data("options").input_id},subscribe:function(a,b){a=$(a),a.find(".examinr-run-button").on("click.examinrExerciseInputBinding",function(){h&&(a.data("sendData",!0),c(a.find(".examinr-exercise-output"),!0),b(!0))})},unsubscribe:function(a){$(a).find(".examinr-run-button").off(".examinrExerciseInputBinding")},getValue:function(a){return a=$(a),!0!==a.data("sendData")?null:(a.data("sendData",!1),{label:a.data("options").label,output_id:a.data("options").output_id,code:a.data("editor").getSession().getValue(),timestamp:(new Date).getTime()})},setValue:function(a,b){$(a).data("editor").getSession().setValue(b)}}),Shiny.inputBindings.register(a,"examinr.exerciseInputBinding");var b=new Shiny.OutputBinding;$.extend(b,{find:function(a){return $(a).find(".examinr-exercise")},getId:function(a){return $(a).data("options").output_id},renderValue:function(a,b){a=$(a),b.result?a.find(".examinr-exercise-output").show().html(b.result):a.find(".examinr-exercise-output").hide().html(""),b.status?(a.find(".examinr-exercise-status").removeClass("alert-success").removeClass("alert-info").removeClass("alert-warning").removeClass("alert-danger").addClass("alert-"+(b.status_class||"info")),a.find(".examinr-exercise-status").show().html(b.status)):a.find(".examinr-exercise-status").hide().html(""),c(a.find(".examinr-exercise-output"),!1)},renderError:function(a,b){a=$(a),c(a.find(".examinr-exercise-output"),!1),a.find(".examinr-exercise-output").hide(),a.find(".examinr-exercise-status").show().text(b.message)},clearError:function(a){a=$(a),c(a.find(".examinr-exercise-output"),!1),a.find(".examinr-exercise-output").hide(),a.find(".examinr-exercise-status").hide()}}),Shiny.outputBindings.register(b,"examinr.exerciseOutputBinding")}var f=5,g=20,h=!0;return $(document).ready(function(){d(),e()}),{toggleRecomputeOverlay:b}}();
//# sourceMappingURL=exam.min.js.map